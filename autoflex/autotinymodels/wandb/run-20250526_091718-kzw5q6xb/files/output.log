✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

✓ Main ViT model already exists at ../../cifar10checkpoints/bestmodel_main/best_model.pt

✓ Robust ViT model already exists at ../../cifar10checkpoints/bestmodel_robust/best_model.pt

✓ ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_baseline/best_model.pt

✓ Pretrained ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_pretrained/best_model.pt

✓ TTT model already exists at ../../cifar10checkpoints/bestmodel_ttt/best_model.pt

=== TRAINING TTT MODELS ===
✓ TTT model already exists at ../../cifar10checkpoints/bestmodel_ttt/best_model.pt, skipping training
✅ Loaded base model for TTT training

🚀 Training TTT3fc model on CIFAR-10...
TTT3fc Epoch 1/50: 100%|██████████████████████| 391/391 [00:30<00:00, 12.99it/s]
TTT3fc Epoch 1: Train Loss: 1.2864, Val Loss: 1.2155
TTT3fc Epoch 2/50: 100%|██████████████████████| 391/391 [00:30<00:00, 13.02it/s]
TTT3fc Epoch 2: Train Loss: 1.0797, Val Loss: 0.8192
TTT3fc Epoch 3/50: 100%|██████████████████████| 391/391 [00:22<00:00, 17.64it/s]
TTT3fc Epoch 3: Train Loss: 0.7622, Val Loss: 0.7494
TTT3fc Epoch 4/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.28it/s]
TTT3fc Epoch 4: Train Loss: 0.7129, Val Loss: 0.6774
TTT3fc Epoch 5/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.16it/s]
TTT3fc Epoch 5: Train Loss: 0.6940, Val Loss: 0.6824
TTT3fc Epoch 6/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.06it/s]
TTT3fc Epoch 6: Train Loss: 0.6789, Val Loss: 0.6709
TTT3fc Epoch 7/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.08it/s]
TTT3fc Epoch 7: Train Loss: 0.6624, Val Loss: 0.6443
TTT3fc Epoch 8/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.18it/s]
TTT3fc Epoch 8: Train Loss: 0.6469, Val Loss: 0.6299
TTT3fc Epoch 9/50: 100%|██████████████████████| 391/391 [00:21<00:00, 18.18it/s]
TTT3fc Epoch 9: Train Loss: 0.6388, Val Loss: 0.6053
TTT3fc Epoch 10/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.17it/s]
TTT3fc Epoch 10: Train Loss: 0.6363, Val Loss: 0.6384
TTT3fc Epoch 11/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.17it/s]
TTT3fc Epoch 11: Train Loss: 0.6230, Val Loss: 0.6000
TTT3fc Epoch 12/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.17it/s]
TTT3fc Epoch 12: Train Loss: 0.6151, Val Loss: 0.5901
TTT3fc Epoch 13/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.09it/s]
TTT3fc Epoch 13: Train Loss: 0.6125, Val Loss: 0.6090
TTT3fc Epoch 14/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.07it/s]
TTT3fc Epoch 14: Train Loss: 0.5989, Val Loss: 0.5786
TTT3fc Epoch 15/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.12it/s]
TTT3fc Epoch 15: Train Loss: 0.5958, Val Loss: 0.5702
TTT3fc Epoch 16/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.09it/s]
TTT3fc Epoch 16: Train Loss: 0.5886, Val Loss: 0.5887
TTT3fc Epoch 17/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.08it/s]
TTT3fc Epoch 17: Train Loss: 0.5885, Val Loss: 0.5754
TTT3fc Epoch 18/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.06it/s]
TTT3fc Epoch 18: Train Loss: 0.5849, Val Loss: 0.5835
TTT3fc Epoch 19/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.10it/s]
TTT3fc Epoch 19: Train Loss: 0.5809, Val Loss: 0.5611
TTT3fc Epoch 20/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.09it/s]
TTT3fc Epoch 20: Train Loss: 0.5740, Val Loss: 0.5523
TTT3fc Epoch 21/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.10it/s]
TTT3fc Epoch 21: Train Loss: 0.5756, Val Loss: 0.5540
TTT3fc Epoch 22/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.08it/s]
TTT3fc Epoch 22: Train Loss: 0.5657, Val Loss: 0.5626
TTT3fc Epoch 23/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.05it/s]
TTT3fc Epoch 23: Train Loss: 0.5692, Val Loss: 0.5489
TTT3fc Epoch 24/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.04it/s]
TTT3fc Epoch 24: Train Loss: 0.5639, Val Loss: 0.5411
TTT3fc Epoch 25/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.10it/s]
TTT3fc Epoch 25: Train Loss: 0.5593, Val Loss: 0.5620
TTT3fc Epoch 26/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.06it/s]
TTT3fc Epoch 26: Train Loss: 0.5638, Val Loss: 0.5361
TTT3fc Epoch 27/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.13it/s]
TTT3fc Epoch 27: Train Loss: 0.5586, Val Loss: 0.5419
TTT3fc Epoch 28/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.07it/s]
TTT3fc Epoch 28: Train Loss: 0.5552, Val Loss: 0.5342
TTT3fc Epoch 29/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.05it/s]
TTT3fc Epoch 29: Train Loss: 0.5529, Val Loss: 0.5430
TTT3fc Epoch 30/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.05it/s]
TTT3fc Epoch 30: Train Loss: 0.5470, Val Loss: 0.5289
TTT3fc Epoch 31/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.06it/s]
TTT3fc Epoch 31: Train Loss: 0.5477, Val Loss: 0.5367
TTT3fc Epoch 32/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.06it/s]
TTT3fc Epoch 32: Train Loss: 0.5399, Val Loss: 0.5265
TTT3fc Epoch 33/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.04it/s]
TTT3fc Epoch 33: Train Loss: 0.5394, Val Loss: 0.5308
TTT3fc Epoch 34/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.04it/s]
TTT3fc Epoch 34: Train Loss: 0.5431, Val Loss: 0.5300
TTT3fc Epoch 35/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 35: Train Loss: 0.5373, Val Loss: 0.5197
TTT3fc Epoch 36/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 36: Train Loss: 0.5358, Val Loss: 0.5296
TTT3fc Epoch 37/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 37: Train Loss: 0.5376, Val Loss: 0.5104
TTT3fc Epoch 38/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.01it/s]
TTT3fc Epoch 38: Train Loss: 0.5309, Val Loss: 0.5313
TTT3fc Epoch 39/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 39: Train Loss: 0.5293, Val Loss: 0.5210
TTT3fc Epoch 40/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 40: Train Loss: 0.5302, Val Loss: 0.5114
TTT3fc Epoch 41/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.01it/s]
TTT3fc Epoch 41: Train Loss: 0.5284, Val Loss: 0.5226
TTT3fc Epoch 42/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.00it/s]
TTT3fc Epoch 42: Train Loss: 0.5235, Val Loss: 0.5063
TTT3fc Epoch 43/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.02it/s]
TTT3fc Epoch 43: Train Loss: 0.5224, Val Loss: 0.5148
TTT3fc Epoch 44/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.01it/s]
TTT3fc Epoch 44: Train Loss: 0.5207, Val Loss: 0.5152
TTT3fc Epoch 45/50: 100%|█████████████████████| 391/391 [00:21<00:00, 17.98it/s]
TTT3fc Epoch 45: Train Loss: 0.5183, Val Loss: 0.5062
TTT3fc Epoch 46/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.00it/s]
TTT3fc Epoch 46: Train Loss: 0.5167, Val Loss: 0.5211
TTT3fc Epoch 47/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.01it/s]
TTT3fc Epoch 47: Train Loss: 0.5202, Val Loss: 0.5239
TTT3fc Epoch 48/50: 100%|█████████████████████| 391/391 [00:21<00:00, 17.96it/s]
TTT3fc Epoch 48: Train Loss: 0.5132, Val Loss: 0.5033
TTT3fc Epoch 49/50: 100%|█████████████████████| 391/391 [00:21<00:00, 18.00it/s]
TTT3fc Epoch 49: Train Loss: 0.5103, Val Loss: 0.4980
TTT3fc Epoch 50/50: 100%|█████████████████████| 391/391 [00:21<00:00, 17.99it/s]
TTT3fc Epoch 50: Train Loss: 0.5111, Val Loss: 0.4951

=== TRAINING BLENDED MODELS ===
✅ Loaded base model for Blended training

🚀 Training BlendedTTT model on CIFAR-10...
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1123, in <module>
    main()
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1104, in main
    train_blended_models(train_loader, val_loader)
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 558, in train_blended_models
    blended_model = BlendedTTT(
                    ^^^^^^^^^^^
TypeError: BlendedTTT.__init__() got an unexpected keyword argument 'num_classes'
