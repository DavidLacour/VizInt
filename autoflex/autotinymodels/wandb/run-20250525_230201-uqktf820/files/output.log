✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

=== TRAINING MAIN VIT MODEL ===

🚀 Training main ViT model on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [01:04<00:00,  6.03it/s, loss=1.8348, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.71it/s]
Epoch 1: Train Loss: 2.0918, Train Acc: 0.2435, Val Loss: 1.6545, Val Acc: 0.3803
  ✅ New best model saved with val_acc: 0.3803
Epoch 2/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.91it/s, loss=1.5748, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 2: Train Loss: 1.6362, Train Acc: 0.3894, Val Loss: 1.5654, Val Acc: 0.4139
  ✅ New best model saved with val_acc: 0.4139
Epoch 3/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.89it/s, loss=1.5978, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.44it/s]
Epoch 3: Train Loss: 1.5449, Train Acc: 0.4286, Val Loss: 1.4855, Val Acc: 0.4589
  ✅ New best model saved with val_acc: 0.4589
Epoch 4/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.91it/s, loss=1.7249, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.42it/s]
Epoch 4: Train Loss: 1.5283, Train Acc: 0.4403, Val Loss: 1.5748, Val Acc: 0.4235
Epoch 5/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.90it/s, loss=1.6696, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.42it/s]
Epoch 5: Train Loss: 1.6560, Train Acc: 0.3868, Val Loss: 1.5317, Val Acc: 0.4244
Epoch 6/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.90it/s, loss=1.3357, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.37it/s]
Epoch 6: Train Loss: 1.5213, Train Acc: 0.4352, Val Loss: 1.4256, Val Acc: 0.4691
  ✅ New best model saved with val_acc: 0.4691
Epoch 7/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.88it/s, loss=1.5462, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.31it/s]
Epoch 7: Train Loss: 1.5357, Train Acc: 0.4302, Val Loss: 1.4761, Val Acc: 0.4474
Epoch 8/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.87it/s, loss=1.4888, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.22it/s]
Epoch 8: Train Loss: 1.5436, Train Acc: 0.4295, Val Loss: 1.5972, Val Acc: 0.4148
Epoch 9/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.87it/s, loss=1.5248, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.18it/s]
Epoch 9: Train Loss: 1.5762, Train Acc: 0.4195, Val Loss: 1.4849, Val Acc: 0.4521
Epoch 10/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.86it/s, loss=1.5674, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.09it/s]
Epoch 10: Train Loss: 1.5316, Train Acc: 0.4388, Val Loss: 1.4747, Val Acc: 0.4522
Epoch 11/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.85it/s, loss=1.5476, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.11it/s]
Epoch 11: Train Loss: 1.5303, Train Acc: 0.4378, Val Loss: 1.5172, Val Acc: 0.4422
Epoch 12/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.85it/s, loss=1.5022, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.12it/s]
Epoch 12: Train Loss: 1.5747, Train Acc: 0.4204, Val Loss: 1.5208, Val Acc: 0.4412
Epoch 13/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.84it/s, loss=1.4483, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.08it/s]
Epoch 13: Train Loss: 1.5153, Train Acc: 0.4400, Val Loss: 1.4272, Val Acc: 0.4764
  ✅ New best model saved with val_acc: 0.4764
Epoch 14/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.4258, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 14: Train Loss: 1.5209, Train Acc: 0.4451, Val Loss: 1.5900, Val Acc: 0.4300
Epoch 15/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.5045, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.05it/s]
Epoch 15: Train Loss: 1.4946, Train Acc: 0.4548, Val Loss: 1.4564, Val Acc: 0.4736
Epoch 16/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.6612, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 16: Train Loss: 1.4418, Train Acc: 0.4690, Val Loss: 1.3566, Val Acc: 0.5038
  ✅ New best model saved with val_acc: 0.5038
Epoch 17/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.4113, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 17: Train Loss: 1.3931, Train Acc: 0.4927, Val Loss: 1.3738, Val Acc: 0.4970
Epoch 18/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.6005, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.03it/s]
Epoch 18: Train Loss: 1.4029, Train Acc: 0.4890, Val Loss: 1.3375, Val Acc: 0.5127
  ✅ New best model saved with val_acc: 0.5127
Epoch 19/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.3579, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.03it/s]
Epoch 19: Train Loss: 1.3578, Train Acc: 0.5075, Val Loss: 1.3233, Val Acc: 0.5151
  ✅ New best model saved with val_acc: 0.5151
Epoch 20/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.3645, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 20: Train Loss: 1.3519, Train Acc: 0.5077, Val Loss: 1.3085, Val Acc: 0.5244
  ✅ New best model saved with val_acc: 0.5244
Epoch 21/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1063, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 21: Train Loss: 1.3635, Train Acc: 0.5050, Val Loss: 1.2629, Val Acc: 0.5431
  ✅ New best model saved with val_acc: 0.5431
Epoch 22/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.4109, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 22: Train Loss: 1.2939, Train Acc: 0.5310, Val Loss: 1.2168, Val Acc: 0.5632
  ✅ New best model saved with val_acc: 0.5632
Epoch 23/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1763, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 23: Train Loss: 1.2700, Train Acc: 0.5398, Val Loss: 1.2027, Val Acc: 0.5629
Epoch 24/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1047, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.88it/s]
Epoch 24: Train Loss: 1.2291, Train Acc: 0.5567, Val Loss: 1.1909, Val Acc: 0.5699
  ✅ New best model saved with val_acc: 0.5699
Epoch 25/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1670, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.90it/s]
Epoch 25: Train Loss: 1.2024, Train Acc: 0.5657, Val Loss: 1.1626, Val Acc: 0.5813
  ✅ New best model saved with val_acc: 0.5813
Epoch 26/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2984, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 26: Train Loss: 1.1865, Train Acc: 0.5725, Val Loss: 1.1395, Val Acc: 0.5890
  ✅ New best model saved with val_acc: 0.5890
Epoch 27/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2218, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 27: Train Loss: 1.1652, Train Acc: 0.5797, Val Loss: 1.1479, Val Acc: 0.5817
Epoch 28/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0965, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 28: Train Loss: 1.1326, Train Acc: 0.5925, Val Loss: 1.0864, Val Acc: 0.6034
  ✅ New best model saved with val_acc: 0.6034
Epoch 29/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9906, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 29: Train Loss: 1.1030, Train Acc: 0.6041, Val Loss: 1.0575, Val Acc: 0.6174
  ✅ New best model saved with val_acc: 0.6174
Epoch 30/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.3364, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 30: Train Loss: 1.0709, Train Acc: 0.6157, Val Loss: 1.0528, Val Acc: 0.6230
  ✅ New best model saved with val_acc: 0.6230
Epoch 31/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2526, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 31: Train Loss: 1.0579, Train Acc: 0.6214, Val Loss: 1.0028, Val Acc: 0.6456
  ✅ New best model saved with val_acc: 0.6456
Epoch 32/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0798, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 32: Train Loss: 1.0257, Train Acc: 0.6331, Val Loss: 1.0371, Val Acc: 0.6344
Epoch 33/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=1.0967, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 33: Train Loss: 0.9996, Train Acc: 0.6441, Val Loss: 0.9858, Val Acc: 0.6516
  ✅ New best model saved with val_acc: 0.6516
Epoch 34/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9953, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 34: Train Loss: 0.9674, Train Acc: 0.6532, Val Loss: 0.9574, Val Acc: 0.6589
  ✅ New best model saved with val_acc: 0.6589
Epoch 35/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9726, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 35: Train Loss: 0.9505, Train Acc: 0.6593, Val Loss: 0.9685, Val Acc: 0.6546
Epoch 36/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.8271, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 36: Train Loss: 0.9124, Train Acc: 0.6727, Val Loss: 0.8883, Val Acc: 0.6842
  ✅ New best model saved with val_acc: 0.6842
Epoch 37/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7892, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 37: Train Loss: 0.8805, Train Acc: 0.6852, Val Loss: 0.8865, Val Acc: 0.6884
  ✅ New best model saved with val_acc: 0.6884
Epoch 38/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.8051, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 38: Train Loss: 0.8638, Train Acc: 0.6910, Val Loss: 0.8995, Val Acc: 0.6854
Epoch 39/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.7935, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 39: Train Loss: 0.8280, Train Acc: 0.7061, Val Loss: 0.8483, Val Acc: 0.6994
  ✅ New best model saved with val_acc: 0.6994
Epoch 40/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.9116, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 40: Train Loss: 0.8045, Train Acc: 0.7147, Val Loss: 0.8313, Val Acc: 0.7022
  ✅ New best model saved with val_acc: 0.7022
Epoch 41/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.7115, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 41: Train Loss: 0.7811, Train Acc: 0.7225, Val Loss: 0.7904, Val Acc: 0.7198
  ✅ New best model saved with val_acc: 0.7198
Epoch 42/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.6923, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 42: Train Loss: 0.7497, Train Acc: 0.7334, Val Loss: 0.8348, Val Acc: 0.7023
Epoch 43/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.8213, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 43: Train Loss: 0.7230, Train Acc: 0.7439, Val Loss: 0.7535, Val Acc: 0.7333
  ✅ New best model saved with val_acc: 0.7333
Epoch 44/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.6676, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.86it/s]
Epoch 44: Train Loss: 0.6951, Train Acc: 0.7537, Val Loss: 0.7699, Val Acc: 0.7289
Epoch 45/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.7930, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 45: Train Loss: 0.6596, Train Acc: 0.7664, Val Loss: 0.7298, Val Acc: 0.7430
  ✅ New best model saved with val_acc: 0.7430
Epoch 46/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.7173, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 46: Train Loss: 0.6282, Train Acc: 0.7761, Val Loss: 0.7126, Val Acc: 0.7561
  ✅ New best model saved with val_acc: 0.7561
Epoch 47/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.6869, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 47: Train Loss: 0.5986, Train Acc: 0.7867, Val Loss: 0.7477, Val Acc: 0.7426
Epoch 48/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.6015, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 48: Train Loss: 0.5681, Train Acc: 0.7958, Val Loss: 0.7320, Val Acc: 0.7515
Epoch 49/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.6782, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.87it/s]
Epoch 49: Train Loss: 0.5386, Train Acc: 0.8075, Val Loss: 0.7086, Val Acc: 0.7608
  ✅ New best model saved with val_acc: 0.7608
Epoch 50/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.4818, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.85it/s]
Epoch 50: Train Loss: 0.5119, Train Acc: 0.8174, Val Loss: 0.6596, Val Acc: 0.7718
  ✅ New best model saved with val_acc: 0.7718
Epoch 51/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.4469, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.90it/s]
Epoch 51: Train Loss: 0.4851, Train Acc: 0.8276, Val Loss: 0.6461, Val Acc: 0.7813
  ✅ New best model saved with val_acc: 0.7813
Epoch 52/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.5192, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.91it/s]
Epoch 52: Train Loss: 0.4580, Train Acc: 0.8356, Val Loss: 0.6740, Val Acc: 0.7723
Epoch 53/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.3720, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.90it/s]
Epoch 53: Train Loss: 0.4261, Train Acc: 0.8477, Val Loss: 0.6699, Val Acc: 0.7789
Epoch 54/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.3102, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 54: Train Loss: 0.3982, Train Acc: 0.8571, Val Loss: 0.6681, Val Acc: 0.7832
  ✅ New best model saved with val_acc: 0.7832
Epoch 55/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.3019, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 55: Train Loss: 0.3706, Train Acc: 0.8672, Val Loss: 0.6647, Val Acc: 0.7847
  ✅ New best model saved with val_acc: 0.7847
Epoch 56/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.80it/s, loss=0.3206, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 56: Train Loss: 0.3430, Train Acc: 0.8767, Val Loss: 0.6623, Val Acc: 0.7915
  ✅ New best model saved with val_acc: 0.7915
Epoch 57/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2172, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 57: Train Loss: 0.3113, Train Acc: 0.8884, Val Loss: 0.6733, Val Acc: 0.7897
Epoch 58/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3650, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 58: Train Loss: 0.2873, Train Acc: 0.8976, Val Loss: 0.7144, Val Acc: 0.7817
Epoch 59/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2293, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 59: Train Loss: 0.2612, Train Acc: 0.9064, Val Loss: 0.7262, Val Acc: 0.7862
Epoch 60/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1079, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 60: Train Loss: 0.2388, Train Acc: 0.9154, Val Loss: 0.7137, Val Acc: 0.7951
  ✅ New best model saved with val_acc: 0.7951
Epoch 61/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1769, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 61: Train Loss: 0.2104, Train Acc: 0.9243, Val Loss: 0.7718, Val Acc: 0.7951
Epoch 62/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2192, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 62: Train Loss: 0.1927, Train Acc: 0.9317, Val Loss: 0.7674, Val Acc: 0.7882
Epoch 63/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.2405, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 63: Train Loss: 0.1730, Train Acc: 0.9389, Val Loss: 0.8046, Val Acc: 0.7898
Epoch 64/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2176, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 64: Train Loss: 0.1563, Train Acc: 0.9453, Val Loss: 0.8409, Val Acc: 0.7851
Epoch 65/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1804, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 65: Train Loss: 0.1364, Train Acc: 0.9508, Val Loss: 0.8258, Val Acc: 0.7891
Epoch 66/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1717, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 66: Train Loss: 0.1226, Train Acc: 0.9564, Val Loss: 0.8297, Val Acc: 0.7961
  ✅ New best model saved with val_acc: 0.7961
Epoch 67/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0886, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 67: Train Loss: 0.1111, Train Acc: 0.9618, Val Loss: 0.8449, Val Acc: 0.7979
  ✅ New best model saved with val_acc: 0.7979
Epoch 68/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1673, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 68: Train Loss: 0.0943, Train Acc: 0.9669, Val Loss: 0.9284, Val Acc: 0.7884
Epoch 69/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0585, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 69: Train Loss: 0.0905, Train Acc: 0.9691, Val Loss: 0.9128, Val Acc: 0.7924
Epoch 70/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0699, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 70: Train Loss: 0.0835, Train Acc: 0.9710, Val Loss: 0.9351, Val Acc: 0.7914
Epoch 71/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0193, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 71: Train Loss: 0.0681, Train Acc: 0.9765, Val Loss: 0.9607, Val Acc: 0.7894
Epoch 72/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0407, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 72: Train Loss: 0.0636, Train Acc: 0.9779, Val Loss: 0.9775, Val Acc: 0.7945
Epoch 73/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0534, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 73: Train Loss: 0.0535, Train Acc: 0.9828, Val Loss: 0.9768, Val Acc: 0.8013
  ✅ New best model saved with val_acc: 0.8013
Epoch 74/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0731, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 74: Train Loss: 0.0483, Train Acc: 0.9839, Val Loss: 0.9909, Val Acc: 0.7986
Epoch 75/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0837, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 75: Train Loss: 0.0451, Train Acc: 0.9847, Val Loss: 1.0212, Val Acc: 0.7956
Epoch 76/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0524, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 76: Train Loss: 0.0402, Train Acc: 0.9863, Val Loss: 1.0429, Val Acc: 0.7994
Epoch 77/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.1330, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 77: Train Loss: 0.0395, Train Acc: 0.9871, Val Loss: 1.0459, Val Acc: 0.7958
Epoch 78/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0176, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 78: Train Loss: 0.0333, Train Acc: 0.9891, Val Loss: 1.0830, Val Acc: 0.7985
Epoch 79/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0132, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 79: Train Loss: 0.0308, Train Acc: 0.9900, Val Loss: 1.0656, Val Acc: 0.8010
Epoch 80/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0467, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 80: Train Loss: 0.0262, Train Acc: 0.9915, Val Loss: 1.0938, Val Acc: 0.8001
Epoch 81/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0564, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 81: Train Loss: 0.0243, Train Acc: 0.9924, Val Loss: 1.1171, Val Acc: 0.7989
Epoch 82/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0549, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 82: Train Loss: 0.0220, Train Acc: 0.9926, Val Loss: 1.1202, Val Acc: 0.7993
Epoch 83/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0098, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 83: Train Loss: 0.0199, Train Acc: 0.9934, Val Loss: 1.1075, Val Acc: 0.8050
  ✅ New best model saved with val_acc: 0.8050
Epoch 84/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0032, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 84: Train Loss: 0.0180, Train Acc: 0.9943, Val Loss: 1.1182, Val Acc: 0.8034
Epoch 85/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0052, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 85: Train Loss: 0.0140, Train Acc: 0.9961, Val Loss: 1.1355, Val Acc: 0.8038
Epoch 86/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0125, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 86: Train Loss: 0.0134, Train Acc: 0.9957, Val Loss: 1.1510, Val Acc: 0.8031
Epoch 87/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0196, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 87: Train Loss: 0.0121, Train Acc: 0.9964, Val Loss: 1.1613, Val Acc: 0.8002
Epoch 88/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0040, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 88: Train Loss: 0.0116, Train Acc: 0.9963, Val Loss: 1.1620, Val Acc: 0.8046
Epoch 89/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0066, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 89: Train Loss: 0.0093, Train Acc: 0.9973, Val Loss: 1.1850, Val Acc: 0.8047
Epoch 90/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0032, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 90: Train Loss: 0.0104, Train Acc: 0.9967, Val Loss: 1.1820, Val Acc: 0.8030
Epoch 91/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0038, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 91: Train Loss: 0.0084, Train Acc: 0.9975, Val Loss: 1.1821, Val Acc: 0.8038
Epoch 92/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0065, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 92: Train Loss: 0.0076, Train Acc: 0.9981, Val Loss: 1.1923, Val Acc: 0.8038
Epoch 93/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0034, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 93: Train Loss: 0.0070, Train Acc: 0.9983, Val Loss: 1.1975, Val Acc: 0.8051
  ✅ New best model saved with val_acc: 0.8051
Epoch 94/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0048, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 94: Train Loss: 0.0067, Train Acc: 0.9980, Val Loss: 1.1980, Val Acc: 0.8048
Epoch 95/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0008, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 95: Train Loss: 0.0060, Train Acc: 0.9983, Val Loss: 1.2029, Val Acc: 0.8069
  ✅ New best model saved with val_acc: 0.8069
Epoch 96/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0030, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 96: Train Loss: 0.0056, Train Acc: 0.9985, Val Loss: 1.2108, Val Acc: 0.8055
Epoch 97/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0052, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 97: Train Loss: 0.0053, Train Acc: 0.9986, Val Loss: 1.2067, Val Acc: 0.8062
Epoch 98/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0027, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 98: Train Loss: 0.0055, Train Acc: 0.9984, Val Loss: 1.2047, Val Acc: 0.8061
Epoch 99/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0004, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 99: Train Loss: 0.0055, Train Acc: 0.9986, Val Loss: 1.2046, Val Acc: 0.8070
  ✅ New best model saved with val_acc: 0.8070
Epoch 100/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.0033, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 100: Train Loss: 0.0054, Train Acc: 0.9985, Val Loss: 1.2045, Val Acc: 0.8075
  ✅ New best model saved with val_acc: 0.8075
✅ Training completed. Best validation accuracy: 0.8075

=== TRAINING ROBUST VIT MODEL ===

🚀 Training robust ViT model on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.85it/s, loss=1.9741, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.14it/s]
Epoch 1: Train Loss: 2.1234, Train Acc: 0.2297, Val Loss: 1.7939, Val Acc: 0.3263
  ✅ New best model saved with val_acc: 0.3263
Epoch 2/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.84it/s, loss=1.7318, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 2: Train Loss: 1.7126, Train Acc: 0.3561, Val Loss: 1.5980, Val Acc: 0.3981
  ✅ New best model saved with val_acc: 0.3981
Epoch 3/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.84it/s, loss=1.6255, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.13it/s]
Epoch 3: Train Loss: 1.5819, Train Acc: 0.4085, Val Loss: 1.4539, Val Acc: 0.4547
  ✅ New best model saved with val_acc: 0.4547
Epoch 4/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.8523, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 4: Train Loss: 1.5622, Train Acc: 0.4262, Val Loss: 1.5373, Val Acc: 0.4248
Epoch 5/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.7229, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.11it/s]
Epoch 5: Train Loss: 1.5585, Train Acc: 0.4264, Val Loss: 1.4826, Val Acc: 0.4553
  ✅ New best model saved with val_acc: 0.4553
Epoch 6/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.5182, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 6: Train Loss: 1.5321, Train Acc: 0.4380, Val Loss: 1.4831, Val Acc: 0.4515
Epoch 7/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.5538, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 7: Train Loss: 1.5216, Train Acc: 0.4446, Val Loss: 1.4158, Val Acc: 0.4848
  ✅ New best model saved with val_acc: 0.4848
Epoch 8/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.5115, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 8: Train Loss: 1.4798, Train Acc: 0.4578, Val Loss: 1.4503, Val Acc: 0.4618
Epoch 9/100 [Train]: 100%|█| 391/391 [01:06<00:00,  5.84it/s, loss=1.4808, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 18.06it/s]
Epoch 9: Train Loss: 1.4757, Train Acc: 0.4604, Val Loss: 1.4023, Val Acc: 0.4830
Epoch 10/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.83it/s, loss=1.5049, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.07it/s]
Epoch 10: Train Loss: 1.4390, Train Acc: 0.4739, Val Loss: 1.3876, Val Acc: 0.4878
  ✅ New best model saved with val_acc: 0.4878
Epoch 11/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.5772, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.03it/s]
Epoch 11: Train Loss: 1.4710, Train Acc: 0.4602, Val Loss: 1.3838, Val Acc: 0.4994
  ✅ New best model saved with val_acc: 0.4994
Epoch 12/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.2165, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.08it/s]
Epoch 12: Train Loss: 1.4023, Train Acc: 0.4888, Val Loss: 1.3016, Val Acc: 0.5279
  ✅ New best model saved with val_acc: 0.5279
Epoch 13/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.4589, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 13: Train Loss: 1.3622, Train Acc: 0.5046, Val Loss: 1.2989, Val Acc: 0.5273
Epoch 14/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2454, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.02it/s]
Epoch 14: Train Loss: 1.4042, Train Acc: 0.4884, Val Loss: 1.3402, Val Acc: 0.5154
Epoch 15/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.3096, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 15: Train Loss: 1.3770, Train Acc: 0.4973, Val Loss: 1.2858, Val Acc: 0.5372
  ✅ New best model saved with val_acc: 0.5372
Epoch 16/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.5161, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 16: Train Loss: 1.3422, Train Acc: 0.5123, Val Loss: 1.2667, Val Acc: 0.5379
  ✅ New best model saved with val_acc: 0.5379
Epoch 17/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.4202, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 17: Train Loss: 1.3445, Train Acc: 0.5111, Val Loss: 1.3143, Val Acc: 0.5215
Epoch 18/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=1.4111, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 18: Train Loss: 1.3403, Train Acc: 0.5111, Val Loss: 1.3213, Val Acc: 0.5190
Epoch 19/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.3386, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 19: Train Loss: 1.3828, Train Acc: 0.5011, Val Loss: 1.3313, Val Acc: 0.5190
Epoch 20/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.3057, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 20: Train Loss: 1.3288, Train Acc: 0.5189, Val Loss: 1.2731, Val Acc: 0.5391
  ✅ New best model saved with val_acc: 0.5391
Epoch 21/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1095, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 21: Train Loss: 1.3064, Train Acc: 0.5253, Val Loss: 1.2846, Val Acc: 0.5290
Epoch 22/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1916, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 22: Train Loss: 1.2617, Train Acc: 0.5424, Val Loss: 1.1561, Val Acc: 0.5784
  ✅ New best model saved with val_acc: 0.5784
Epoch 23/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9922, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 23: Train Loss: 1.2290, Train Acc: 0.5554, Val Loss: 1.1556, Val Acc: 0.5754
Epoch 24/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1672, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 24: Train Loss: 1.2038, Train Acc: 0.5630, Val Loss: 1.1917, Val Acc: 0.5620
Epoch 25/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2833, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 25: Train Loss: 1.2097, Train Acc: 0.5628, Val Loss: 1.1724, Val Acc: 0.5752
Epoch 26/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.3483, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.85it/s]
Epoch 26: Train Loss: 1.1885, Train Acc: 0.5703, Val Loss: 1.1484, Val Acc: 0.5910
  ✅ New best model saved with val_acc: 0.5910
Epoch 27/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.1985, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 27: Train Loss: 1.1613, Train Acc: 0.5789, Val Loss: 1.1086, Val Acc: 0.5965
  ✅ New best model saved with val_acc: 0.5965
Epoch 28/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0336, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 28: Train Loss: 1.1380, Train Acc: 0.5880, Val Loss: 1.0850, Val Acc: 0.6038
  ✅ New best model saved with val_acc: 0.6038
Epoch 29/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9861, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 29: Train Loss: 1.1173, Train Acc: 0.5970, Val Loss: 1.0689, Val Acc: 0.6136
  ✅ New best model saved with val_acc: 0.6136
Epoch 30/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2699, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 30: Train Loss: 1.0932, Train Acc: 0.6082, Val Loss: 1.0569, Val Acc: 0.6218
  ✅ New best model saved with val_acc: 0.6218
Epoch 31/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.2094, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 31: Train Loss: 1.0834, Train Acc: 0.6111, Val Loss: 1.0103, Val Acc: 0.6351
  ✅ New best model saved with val_acc: 0.6351
Epoch 32/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0764, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 32: Train Loss: 1.0428, Train Acc: 0.6246, Val Loss: 1.0170, Val Acc: 0.6324
Epoch 33/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0717, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 33: Train Loss: 1.0380, Train Acc: 0.6275, Val Loss: 0.9822, Val Acc: 0.6456
  ✅ New best model saved with val_acc: 0.6456
Epoch 34/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0679, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 34: Train Loss: 1.0065, Train Acc: 0.6389, Val Loss: 0.9663, Val Acc: 0.6483
  ✅ New best model saved with val_acc: 0.6483
Epoch 35/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9850, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 35: Train Loss: 0.9814, Train Acc: 0.6472, Val Loss: 0.9626, Val Acc: 0.6582
  ✅ New best model saved with val_acc: 0.6582
Epoch 36/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=1.0486, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.91it/s]
Epoch 36: Train Loss: 0.9551, Train Acc: 0.6588, Val Loss: 0.9397, Val Acc: 0.6634
  ✅ New best model saved with val_acc: 0.6634
Epoch 37/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9533, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 37: Train Loss: 0.9361, Train Acc: 0.6647, Val Loss: 0.9187, Val Acc: 0.6720
  ✅ New best model saved with val_acc: 0.6720
Epoch 38/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.6853, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 38: Train Loss: 0.9161, Train Acc: 0.6725, Val Loss: 0.9352, Val Acc: 0.6665
Epoch 39/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.9176, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 39: Train Loss: 0.8846, Train Acc: 0.6832, Val Loss: 0.8522, Val Acc: 0.7026
  ✅ New best model saved with val_acc: 0.7026
Epoch 40/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.8845, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 40: Train Loss: 0.8582, Train Acc: 0.6910, Val Loss: 0.8552, Val Acc: 0.6945
Epoch 41/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7489, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.91it/s]
Epoch 41: Train Loss: 0.8344, Train Acc: 0.7009, Val Loss: 0.8361, Val Acc: 0.7036
  ✅ New best model saved with val_acc: 0.7036
Epoch 42/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.6638, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:05<00:00, 14.41it/s]
Epoch 42: Train Loss: 0.8147, Train Acc: 0.7072, Val Loss: 0.8672, Val Acc: 0.6938
Epoch 43/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7960, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 43: Train Loss: 0.7892, Train Acc: 0.7187, Val Loss: 0.8178, Val Acc: 0.7111
  ✅ New best model saved with val_acc: 0.7111
Epoch 44/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.8260, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 44: Train Loss: 0.7650, Train Acc: 0.7267, Val Loss: 0.7734, Val Acc: 0.7260
  ✅ New best model saved with val_acc: 0.7260
Epoch 45/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7372, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 45: Train Loss: 0.7369, Train Acc: 0.7359, Val Loss: 0.7532, Val Acc: 0.7343
  ✅ New best model saved with val_acc: 0.7343
Epoch 46/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.8915, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 46: Train Loss: 0.7101, Train Acc: 0.7445, Val Loss: 0.7469, Val Acc: 0.7396
  ✅ New best model saved with val_acc: 0.7396
Epoch 47/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.8242, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 47: Train Loss: 0.6801, Train Acc: 0.7572, Val Loss: 0.7618, Val Acc: 0.7388
Epoch 48/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7128, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.90it/s]
Epoch 48: Train Loss: 0.6431, Train Acc: 0.7693, Val Loss: 0.7432, Val Acc: 0.7512
  ✅ New best model saved with val_acc: 0.7512
Epoch 49/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.7566, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 49: Train Loss: 0.6144, Train Acc: 0.7799, Val Loss: 0.7072, Val Acc: 0.7542
  ✅ New best model saved with val_acc: 0.7542
Epoch 50/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.5825, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 50: Train Loss: 0.5820, Train Acc: 0.7904, Val Loss: 0.7029, Val Acc: 0.7562
  ✅ New best model saved with val_acc: 0.7562
Epoch 51/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.5493, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 51: Train Loss: 0.5514, Train Acc: 0.8027, Val Loss: 0.6915, Val Acc: 0.7635
  ✅ New best model saved with val_acc: 0.7635
Epoch 52/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.5187, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.89it/s]
Epoch 52: Train Loss: 0.5274, Train Acc: 0.8108, Val Loss: 0.6966, Val Acc: 0.7645
  ✅ New best model saved with val_acc: 0.7645
Epoch 53/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.4178, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 53: Train Loss: 0.4992, Train Acc: 0.8200, Val Loss: 0.7079, Val Acc: 0.7612
Epoch 54/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3997, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 54: Train Loss: 0.4709, Train Acc: 0.8322, Val Loss: 0.7123, Val Acc: 0.7650
  ✅ New best model saved with val_acc: 0.7650
Epoch 55/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3313, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 55: Train Loss: 0.4293, Train Acc: 0.8454, Val Loss: 0.7673, Val Acc: 0.7601
Epoch 56/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.4428, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 56: Train Loss: 0.4107, Train Acc: 0.8539, Val Loss: 0.7236, Val Acc: 0.7698
  ✅ New best model saved with val_acc: 0.7698
Epoch 57/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3863, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 57: Train Loss: 0.3743, Train Acc: 0.8639, Val Loss: 0.7645, Val Acc: 0.7588
Epoch 58/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3988, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 58: Train Loss: 0.3444, Train Acc: 0.8753, Val Loss: 0.7820, Val Acc: 0.7657
Epoch 59/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.3668, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 59: Train Loss: 0.3187, Train Acc: 0.8853, Val Loss: 0.7749, Val Acc: 0.7648
Epoch 60/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1445, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 60: Train Loss: 0.2872, Train Acc: 0.8960, Val Loss: 0.7987, Val Acc: 0.7718
  ✅ New best model saved with val_acc: 0.7718
Epoch 61/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.82it/s, loss=0.2225, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 61: Train Loss: 0.2601, Train Acc: 0.9066, Val Loss: 0.8076, Val Acc: 0.7688
Epoch 62/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2536, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 62: Train Loss: 0.2355, Train Acc: 0.9148, Val Loss: 0.8234, Val Acc: 0.7653
Epoch 63/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1391, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 63: Train Loss: 0.2110, Train Acc: 0.9257, Val Loss: 0.8454, Val Acc: 0.7691
Epoch 64/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1052, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 64: Train Loss: 0.1849, Train Acc: 0.9339, Val Loss: 0.9167, Val Acc: 0.7658
Epoch 65/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2030, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.92it/s]
Epoch 65: Train Loss: 0.1688, Train Acc: 0.9396, Val Loss: 0.8953, Val Acc: 0.7691
Epoch 66/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2127, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 66: Train Loss: 0.1486, Train Acc: 0.9467, Val Loss: 0.9080, Val Acc: 0.7751
  ✅ New best model saved with val_acc: 0.7751
Epoch 67/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1505, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 67: Train Loss: 0.1369, Train Acc: 0.9520, Val Loss: 0.9628, Val Acc: 0.7699
Epoch 68/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1951, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 68: Train Loss: 0.1215, Train Acc: 0.9571, Val Loss: 0.9949, Val Acc: 0.7662
Epoch 69/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2010, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 69: Train Loss: 0.1070, Train Acc: 0.9629, Val Loss: 1.0297, Val Acc: 0.7692
Epoch 70/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.2541, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.03it/s]
Epoch 70: Train Loss: 0.0987, Train Acc: 0.9657, Val Loss: 1.0271, Val Acc: 0.7697
Epoch 71/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0525, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 71: Train Loss: 0.0836, Train Acc: 0.9718, Val Loss: 1.0434, Val Acc: 0.7714
Epoch 72/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0989, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 72: Train Loss: 0.0791, Train Acc: 0.9735, Val Loss: 1.0879, Val Acc: 0.7706
Epoch 73/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0734, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 73: Train Loss: 0.0686, Train Acc: 0.9761, Val Loss: 1.0933, Val Acc: 0.7710
Epoch 74/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1209, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.00it/s]
Epoch 74: Train Loss: 0.0646, Train Acc: 0.9779, Val Loss: 1.1497, Val Acc: 0.7693
Epoch 75/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.1619, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 75: Train Loss: 0.0601, Train Acc: 0.9795, Val Loss: 1.1741, Val Acc: 0.7737
Epoch 76/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0600, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 76: Train Loss: 0.0551, Train Acc: 0.9810, Val Loss: 1.1793, Val Acc: 0.7687
Epoch 77/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0586, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 77: Train Loss: 0.0469, Train Acc: 0.9848, Val Loss: 1.1975, Val Acc: 0.7752
  ✅ New best model saved with val_acc: 0.7752
Epoch 78/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0198, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.91it/s]
Epoch 78: Train Loss: 0.0421, Train Acc: 0.9859, Val Loss: 1.1881, Val Acc: 0.7733
Epoch 79/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0403, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 79: Train Loss: 0.0367, Train Acc: 0.9883, Val Loss: 1.2141, Val Acc: 0.7724
Epoch 80/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0414, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.96it/s]
Epoch 80: Train Loss: 0.0343, Train Acc: 0.9884, Val Loss: 1.2345, Val Acc: 0.7738
Epoch 81/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0124, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 81: Train Loss: 0.0343, Train Acc: 0.9888, Val Loss: 1.2550, Val Acc: 0.7719
Epoch 82/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0302, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 82: Train Loss: 0.0277, Train Acc: 0.9908, Val Loss: 1.2536, Val Acc: 0.7746
Epoch 83/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0084, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 83: Train Loss: 0.0245, Train Acc: 0.9920, Val Loss: 1.2845, Val Acc: 0.7765
  ✅ New best model saved with val_acc: 0.7765
Epoch 84/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0523, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 84: Train Loss: 0.0229, Train Acc: 0.9927, Val Loss: 1.3149, Val Acc: 0.7744
Epoch 85/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0285, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 85: Train Loss: 0.0201, Train Acc: 0.9934, Val Loss: 1.3008, Val Acc: 0.7776
  ✅ New best model saved with val_acc: 0.7776
Epoch 86/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0146, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 86: Train Loss: 0.0203, Train Acc: 0.9933, Val Loss: 1.3161, Val Acc: 0.7743
Epoch 87/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0184, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 87: Train Loss: 0.0177, Train Acc: 0.9945, Val Loss: 1.3315, Val Acc: 0.7773
Epoch 88/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0704, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 88: Train Loss: 0.0164, Train Acc: 0.9948, Val Loss: 1.3384, Val Acc: 0.7755
Epoch 89/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0512, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.95it/s]
Epoch 89: Train Loss: 0.0147, Train Acc: 0.9955, Val Loss: 1.3342, Val Acc: 0.7769
Epoch 90/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0080, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 90: Train Loss: 0.0132, Train Acc: 0.9963, Val Loss: 1.3630, Val Acc: 0.7774
Epoch 91/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0093, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 91: Train Loss: 0.0135, Train Acc: 0.9961, Val Loss: 1.3705, Val Acc: 0.7771
Epoch 92/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0494, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 92: Train Loss: 0.0110, Train Acc: 0.9967, Val Loss: 1.3639, Val Acc: 0.7776
Epoch 93/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0101, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.97it/s]
Epoch 93: Train Loss: 0.0117, Train Acc: 0.9965, Val Loss: 1.3675, Val Acc: 0.7777
  ✅ New best model saved with val_acc: 0.7777
Epoch 94/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0080, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 94: Train Loss: 0.0097, Train Acc: 0.9972, Val Loss: 1.3647, Val Acc: 0.7789
  ✅ New best model saved with val_acc: 0.7789
Epoch 95/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0037, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 95: Train Loss: 0.0099, Train Acc: 0.9973, Val Loss: 1.3787, Val Acc: 0.7775
Epoch 96/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0089, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.93it/s]
Epoch 96: Train Loss: 0.0092, Train Acc: 0.9973, Val Loss: 1.3838, Val Acc: 0.7781
Epoch 97/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0082, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.94it/s]
Epoch 97: Train Loss: 0.0082, Train Acc: 0.9978, Val Loss: 1.3799, Val Acc: 0.7783
Epoch 98/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0007, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 17.99it/s]
Epoch 98: Train Loss: 0.0087, Train Acc: 0.9977, Val Loss: 1.3792, Val Acc: 0.7776
Epoch 99/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0093, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:04<00:00, 18.01it/s]
Epoch 99: Train Loss: 0.0078, Train Acc: 0.9979, Val Loss: 1.3857, Val Acc: 0.7770
Epoch 100/100 [Train]: 100%|█| 391/391 [01:07<00:00,  5.81it/s, loss=0.0063, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:04<00:00, 17.98it/s]
Epoch 100: Train Loss: 0.0086, Train Acc: 0.9975, Val Loss: 1.3824, Val Acc: 0.7786
✅ Training completed. Best validation accuracy: 0.7789

=== TRAINING RESNET BASELINE (from scratch) ===
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)

🚀 Training resnet18_baseline on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=1.2309, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.61it/s]
Epoch 1: Train Loss: 1.3773, Train Acc: 0.4989, Val Loss: 1.1667, Val Acc: 0.6008
  ✅ New best model saved with val_acc: 0.6008
Epoch 2/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.8406, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.89it/s]
Epoch 2: Train Loss: 0.8958, Train Acc: 0.6818, Val Loss: 1.0877, Val Acc: 0.6596
  ✅ New best model saved with val_acc: 0.6596
Epoch 3/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.6265, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 3: Train Loss: 0.6739, Train Acc: 0.7651, Val Loss: 0.6380, Val Acc: 0.7829
  ✅ New best model saved with val_acc: 0.7829
Epoch 4/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.6854, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.82it/s]
Epoch 4: Train Loss: 0.5791, Train Acc: 0.7984, Val Loss: 0.5714, Val Acc: 0.8065
  ✅ New best model saved with val_acc: 0.8065
Epoch 5/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.6123, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 5: Train Loss: 0.5006, Train Acc: 0.8272, Val Loss: 0.5495, Val Acc: 0.8120
  ✅ New best model saved with val_acc: 0.8120
Epoch 6/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.5503, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.72it/s]
Epoch 6: Train Loss: 0.4442, Train Acc: 0.8470, Val Loss: 0.5557, Val Acc: 0.8229
  ✅ New best model saved with val_acc: 0.8229
Epoch 7/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.5691, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.54it/s]
Epoch 7: Train Loss: 0.3977, Train Acc: 0.8618, Val Loss: 0.5133, Val Acc: 0.8297
  ✅ New best model saved with val_acc: 0.8297
Epoch 8/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.3512, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 8: Train Loss: 0.3688, Train Acc: 0.8732, Val Loss: 0.4560, Val Acc: 0.8479
  ✅ New best model saved with val_acc: 0.8479
Epoch 9/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.3573, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.80it/s]
Epoch 9: Train Loss: 0.3362, Train Acc: 0.8838, Val Loss: 0.4651, Val Acc: 0.8445
Epoch 10/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.2332, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.81it/s]
Epoch 10: Train Loss: 0.3129, Train Acc: 0.8919, Val Loss: 0.4222, Val Acc: 0.8689
  ✅ New best model saved with val_acc: 0.8689
Epoch 11/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.3310, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.84it/s]
Epoch 11: Train Loss: 0.2882, Train Acc: 0.9000, Val Loss: 0.4018, Val Acc: 0.8701
  ✅ New best model saved with val_acc: 0.8701
Epoch 12/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.2691, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.40it/s]
Epoch 12: Train Loss: 0.2637, Train Acc: 0.9091, Val Loss: 0.4274, Val Acc: 0.8643
Epoch 13/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.2002, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.80it/s]
Epoch 13: Train Loss: 0.2498, Train Acc: 0.9125, Val Loss: 0.3553, Val Acc: 0.8844
  ✅ New best model saved with val_acc: 0.8844
Epoch 14/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.2694, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.27it/s]
Epoch 14: Train Loss: 0.2323, Train Acc: 0.9192, Val Loss: 0.3675, Val Acc: 0.8837
Epoch 15/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.2865, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 15: Train Loss: 0.2216, Train Acc: 0.9239, Val Loss: 0.3633, Val Acc: 0.8829
Epoch 16/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.2541, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 16: Train Loss: 0.2018, Train Acc: 0.9295, Val Loss: 0.3325, Val Acc: 0.8940
  ✅ New best model saved with val_acc: 0.8940
Epoch 17/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.2084, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.80it/s]
Epoch 17: Train Loss: 0.1898, Train Acc: 0.9336, Val Loss: 0.3678, Val Acc: 0.8902
Epoch 18/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.3613, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.83it/s]
Epoch 18: Train Loss: 0.1752, Train Acc: 0.9392, Val Loss: 0.4006, Val Acc: 0.8817
Epoch 19/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.2020, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 19: Train Loss: 0.1648, Train Acc: 0.9427, Val Loss: 0.3302, Val Acc: 0.8996
  ✅ New best model saved with val_acc: 0.8996
Epoch 20/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.2233, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 20: Train Loss: 0.1522, Train Acc: 0.9470, Val Loss: 0.3380, Val Acc: 0.8988
Epoch 21/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.1385, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.78it/s]
Epoch 21: Train Loss: 0.1457, Train Acc: 0.9484, Val Loss: 0.3428, Val Acc: 0.9044
  ✅ New best model saved with val_acc: 0.9044
Epoch 22/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.1373, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 22: Train Loss: 0.1353, Train Acc: 0.9525, Val Loss: 0.4248, Val Acc: 0.8821
Epoch 23/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.1374, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 23: Train Loss: 0.1270, Train Acc: 0.9553, Val Loss: 0.3764, Val Acc: 0.8951
Epoch 24/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.1352, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.57it/s]
Epoch 24: Train Loss: 0.1208, Train Acc: 0.9574, Val Loss: 0.3242, Val Acc: 0.9065
  ✅ New best model saved with val_acc: 0.9065
Epoch 25/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.1550, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 25: Train Loss: 0.1132, Train Acc: 0.9601, Val Loss: 0.3412, Val Acc: 0.9042
Epoch 26/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.1059, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 26: Train Loss: 0.1055, Train Acc: 0.9628, Val Loss: 0.3732, Val Acc: 0.8977
Epoch 27/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0679, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.77it/s]
Epoch 27: Train Loss: 0.1041, Train Acc: 0.9630, Val Loss: 0.3309, Val Acc: 0.9138
  ✅ New best model saved with val_acc: 0.9138
Epoch 28/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.1126, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 28: Train Loss: 0.0942, Train Acc: 0.9668, Val Loss: 0.4146, Val Acc: 0.8957
Epoch 29/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.1462, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.85it/s]
Epoch 29: Train Loss: 0.0896, Train Acc: 0.9694, Val Loss: 0.3544, Val Acc: 0.9065
Epoch 30/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.0325, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.78it/s]
Epoch 30: Train Loss: 0.0830, Train Acc: 0.9709, Val Loss: 0.3194, Val Acc: 0.9160
  ✅ New best model saved with val_acc: 0.9160
Epoch 31/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.1078, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.86it/s]
Epoch 31: Train Loss: 0.0800, Train Acc: 0.9727, Val Loss: 0.3234, Val Acc: 0.9112
Epoch 32/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.76it/s, loss=0.0445, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.97it/s]
Epoch 32: Train Loss: 0.0749, Train Acc: 0.9740, Val Loss: 0.3540, Val Acc: 0.9060
Epoch 33/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0254, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.03it/s]
Epoch 33: Train Loss: 0.0711, Train Acc: 0.9747, Val Loss: 0.3641, Val Acc: 0.9092
Epoch 34/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.77it/s, loss=0.0667, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 34: Train Loss: 0.0652, Train Acc: 0.9775, Val Loss: 0.3578, Val Acc: 0.9111
Epoch 35/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0934, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.66it/s]
Epoch 35: Train Loss: 0.0662, Train Acc: 0.9763, Val Loss: 0.4085, Val Acc: 0.9058
Epoch 36/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0581, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 36: Train Loss: 0.0608, Train Acc: 0.9785, Val Loss: 0.3511, Val Acc: 0.9140
Epoch 37/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.1159, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 37: Train Loss: 0.0569, Train Acc: 0.9804, Val Loss: 0.3849, Val Acc: 0.9075
Epoch 38/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0396, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.83it/s]
Epoch 38: Train Loss: 0.0574, Train Acc: 0.9797, Val Loss: 0.4061, Val Acc: 0.9055
Epoch 39/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0553, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 39: Train Loss: 0.0526, Train Acc: 0.9819, Val Loss: 0.3655, Val Acc: 0.9147
Epoch 40/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0916, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 40: Train Loss: 0.0509, Train Acc: 0.9827, Val Loss: 0.3362, Val Acc: 0.9218
  ✅ New best model saved with val_acc: 0.9218
Epoch 41/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.1019, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 41: Train Loss: 0.0460, Train Acc: 0.9841, Val Loss: 0.3696, Val Acc: 0.9143
Epoch 42/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.1491, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.96it/s]
Epoch 42: Train Loss: 0.0462, Train Acc: 0.9841, Val Loss: 0.3831, Val Acc: 0.9129
Epoch 43/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0519, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.50it/s]
Epoch 43: Train Loss: 0.0405, Train Acc: 0.9857, Val Loss: 0.3516, Val Acc: 0.9195
Epoch 44/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0431, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.87it/s]
Epoch 44: Train Loss: 0.0372, Train Acc: 0.9866, Val Loss: 0.3547, Val Acc: 0.9222
  ✅ New best model saved with val_acc: 0.9222
Epoch 45/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0224, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 45: Train Loss: 0.0384, Train Acc: 0.9866, Val Loss: 0.3889, Val Acc: 0.9184
Epoch 46/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0637, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.95it/s]
Epoch 46: Train Loss: 0.0390, Train Acc: 0.9863, Val Loss: 0.3763, Val Acc: 0.9175
Epoch 47/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0345, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.89it/s]
Epoch 47: Train Loss: 0.0372, Train Acc: 0.9866, Val Loss: 0.3754, Val Acc: 0.9158
Epoch 48/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.2156, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.76it/s]
Epoch 48: Train Loss: 0.0351, Train Acc: 0.9881, Val Loss: 0.3381, Val Acc: 0.9232
  ✅ New best model saved with val_acc: 0.9232
Epoch 49/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0487, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.49it/s]
Epoch 49: Train Loss: 0.0290, Train Acc: 0.9898, Val Loss: 0.3770, Val Acc: 0.9203
Epoch 50/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0632, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 50: Train Loss: 0.0305, Train Acc: 0.9893, Val Loss: 0.3979, Val Acc: 0.9200
Epoch 51/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0079, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 51: Train Loss: 0.0292, Train Acc: 0.9895, Val Loss: 0.3442, Val Acc: 0.9239
  ✅ New best model saved with val_acc: 0.9239
Epoch 52/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0614, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 52: Train Loss: 0.0254, Train Acc: 0.9910, Val Loss: 0.3782, Val Acc: 0.9231
Epoch 53/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0360, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 53: Train Loss: 0.0245, Train Acc: 0.9915, Val Loss: 0.3812, Val Acc: 0.9213
Epoch 54/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0038, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.84it/s]
Epoch 54: Train Loss: 0.0263, Train Acc: 0.9913, Val Loss: 0.3781, Val Acc: 0.9218
Epoch 55/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0275, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.74it/s]
Epoch 55: Train Loss: 0.0215, Train Acc: 0.9929, Val Loss: 0.3435, Val Acc: 0.9303
  ✅ New best model saved with val_acc: 0.9303
Epoch 56/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0098, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 56: Train Loss: 0.0183, Train Acc: 0.9939, Val Loss: 0.3798, Val Acc: 0.9261
Epoch 57/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0052, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 57: Train Loss: 0.0202, Train Acc: 0.9930, Val Loss: 0.3606, Val Acc: 0.9275
Epoch 58/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0075, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 58: Train Loss: 0.0188, Train Acc: 0.9939, Val Loss: 0.3554, Val Acc: 0.9267
Epoch 59/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0022, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 59: Train Loss: 0.0150, Train Acc: 0.9953, Val Loss: 0.3988, Val Acc: 0.9204
Epoch 60/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0178, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.91it/s]
Epoch 60: Train Loss: 0.0189, Train Acc: 0.9933, Val Loss: 0.3854, Val Acc: 0.9243
Epoch 61/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0378, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 61: Train Loss: 0.0147, Train Acc: 0.9952, Val Loss: 0.3634, Val Acc: 0.9293
Epoch 62/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0137, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 62: Train Loss: 0.0159, Train Acc: 0.9945, Val Loss: 0.3717, Val Acc: 0.9257
Epoch 63/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0180, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 63: Train Loss: 0.0115, Train Acc: 0.9960, Val Loss: 0.3760, Val Acc: 0.9264
Epoch 64/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0433, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.08it/s]
Epoch 64: Train Loss: 0.0102, Train Acc: 0.9966, Val Loss: 0.3977, Val Acc: 0.9272
Epoch 65/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0044, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 65: Train Loss: 0.0103, Train Acc: 0.9967, Val Loss: 0.3736, Val Acc: 0.9282
Epoch 66/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0502, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.91it/s]
Epoch 66: Train Loss: 0.0110, Train Acc: 0.9963, Val Loss: 0.4022, Val Acc: 0.9242
Epoch 67/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0001, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 67: Train Loss: 0.0084, Train Acc: 0.9973, Val Loss: 0.3884, Val Acc: 0.9311
  ✅ New best model saved with val_acc: 0.9311
Epoch 68/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0055, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 68: Train Loss: 0.0084, Train Acc: 0.9973, Val Loss: 0.3774, Val Acc: 0.9298
Epoch 69/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0259, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 69: Train Loss: 0.0077, Train Acc: 0.9973, Val Loss: 0.3885, Val Acc: 0.9290
Epoch 70/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0005, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 70: Train Loss: 0.0074, Train Acc: 0.9978, Val Loss: 0.3705, Val Acc: 0.9321
  ✅ New best model saved with val_acc: 0.9321
Epoch 71/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0303, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 71: Train Loss: 0.0071, Train Acc: 0.9978, Val Loss: 0.3762, Val Acc: 0.9338
  ✅ New best model saved with val_acc: 0.9338
Epoch 72/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0003, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 72: Train Loss: 0.0056, Train Acc: 0.9983, Val Loss: 0.3979, Val Acc: 0.9300
Epoch 73/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0026, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.97it/s]
Epoch 73: Train Loss: 0.0053, Train Acc: 0.9983, Val Loss: 0.3783, Val Acc: 0.9341
  ✅ New best model saved with val_acc: 0.9341
Epoch 74/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0004, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.81it/s]
Epoch 74: Train Loss: 0.0034, Train Acc: 0.9989, Val Loss: 0.3842, Val Acc: 0.9314
Epoch 75/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0223, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 75: Train Loss: 0.0044, Train Acc: 0.9985, Val Loss: 0.3896, Val Acc: 0.9355
  ✅ New best model saved with val_acc: 0.9355
Epoch 76/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0018, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 76: Train Loss: 0.0040, Train Acc: 0.9986, Val Loss: 0.3966, Val Acc: 0.9328
Epoch 77/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0000, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 77: Train Loss: 0.0032, Train Acc: 0.9990, Val Loss: 0.3758, Val Acc: 0.9342
Epoch 78/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0055, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.82it/s]
Epoch 78: Train Loss: 0.0030, Train Acc: 0.9992, Val Loss: 0.3816, Val Acc: 0.9351
Epoch 79/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0002, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.38it/s]
Epoch 79: Train Loss: 0.0023, Train Acc: 0.9994, Val Loss: 0.3917, Val Acc: 0.9354
Epoch 80/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0053, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 80: Train Loss: 0.0021, Train Acc: 0.9995, Val Loss: 0.3948, Val Acc: 0.9334
Epoch 81/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0002, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 81: Train Loss: 0.0026, Train Acc: 0.9994, Val Loss: 0.3895, Val Acc: 0.9349
Epoch 82/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0003, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.68it/s]
Epoch 82: Train Loss: 0.0023, Train Acc: 0.9993, Val Loss: 0.3804, Val Acc: 0.9380
  ✅ New best model saved with val_acc: 0.9380
Epoch 83/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0028, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.84it/s]
Epoch 83: Train Loss: 0.0014, Train Acc: 0.9996, Val Loss: 0.3712, Val Acc: 0.9363
Epoch 84/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.94it/s]
Epoch 84: Train Loss: 0.0012, Train Acc: 0.9997, Val Loss: 0.3774, Val Acc: 0.9369
Epoch 85/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.0000, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 85: Train Loss: 0.0013, Train Acc: 0.9996, Val Loss: 0.3765, Val Acc: 0.9380
Epoch 86/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0006, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.71it/s]
Epoch 86: Train Loss: 0.0011, Train Acc: 0.9997, Val Loss: 0.3711, Val Acc: 0.9379
Epoch 87/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 87: Train Loss: 0.0013, Train Acc: 0.9996, Val Loss: 0.3698, Val Acc: 0.9373
Epoch 88/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0076, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 88: Train Loss: 0.0011, Train Acc: 0.9997, Val Loss: 0.3758, Val Acc: 0.9378
Epoch 89/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0019, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 89: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3777, Val Acc: 0.9379
Epoch 90/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0028, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 90: Train Loss: 0.0009, Train Acc: 0.9997, Val Loss: 0.3753, Val Acc: 0.9387
  ✅ New best model saved with val_acc: 0.9387
Epoch 91/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0002, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 91: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3776, Val Acc: 0.9373
Epoch 92/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0001, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 92: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3760, Val Acc: 0.9393
  ✅ New best model saved with val_acc: 0.9393
Epoch 93/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0002, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 93: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3762, Val Acc: 0.9399
  ✅ New best model saved with val_acc: 0.9399
Epoch 94/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0002, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.08it/s]
Epoch 94: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3774, Val Acc: 0.9399
Epoch 95/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0175, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 95: Train Loss: 0.0006, Train Acc: 0.9998, Val Loss: 0.3761, Val Acc: 0.9396
Epoch 96/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0001, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.97it/s]
Epoch 96: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3751, Val Acc: 0.9396
Epoch 97/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0002, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.03it/s]
Epoch 97: Train Loss: 0.0007, Train Acc: 0.9998, Val Loss: 0.3756, Val Acc: 0.9396
Epoch 98/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0006, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.68it/s]
Epoch 98: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3732, Val Acc: 0.9396
Epoch 99/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0009, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 99: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3735, Val Acc: 0.9403
  ✅ New best model saved with val_acc: 0.9403
Epoch 100/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0004, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:01<00:00, 50.91it/s]
Epoch 100: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3755, Val Acc: 0.9403
✅ Training completed. Best validation accuracy: 0.9403

=== TRAINING RESNET BASELINE (pretrained) ===
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

🚀 Training resnet18_pretrained on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.6817, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.62it/s]
Epoch 1: Train Loss: 0.7474, Train Acc: 0.7421, Val Loss: 0.6122, Val Acc: 0.7998
  ✅ New best model saved with val_acc: 0.7998
Epoch 2/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.4807, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 2: Train Loss: 0.4477, Train Acc: 0.8460, Val Loss: 0.4655, Val Acc: 0.8442
  ✅ New best model saved with val_acc: 0.8442
Epoch 3/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.4969, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.86it/s]
Epoch 3: Train Loss: 0.3626, Train Acc: 0.8766, Val Loss: 0.4003, Val Acc: 0.8609
  ✅ New best model saved with val_acc: 0.8609
Epoch 4/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.3309, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 4: Train Loss: 0.3073, Train Acc: 0.8955, Val Loss: 0.3720, Val Acc: 0.8764
  ✅ New best model saved with val_acc: 0.8764
Epoch 5/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.3371, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 5: Train Loss: 0.2716, Train Acc: 0.9062, Val Loss: 0.3265, Val Acc: 0.8962
  ✅ New best model saved with val_acc: 0.8962
Epoch 6/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0965, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 6: Train Loss: 0.2494, Train Acc: 0.9147, Val Loss: 0.3237, Val Acc: 0.8959
Epoch 7/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.1548, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.02it/s]
Epoch 7: Train Loss: 0.2221, Train Acc: 0.9228, Val Loss: 0.3406, Val Acc: 0.8905
Epoch 8/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.78it/s, loss=0.2281, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.84it/s]
Epoch 8: Train Loss: 0.2098, Train Acc: 0.9267, Val Loss: 0.3218, Val Acc: 0.8972
  ✅ New best model saved with val_acc: 0.8972
Epoch 9/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.2258, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.89it/s]
Epoch 9: Train Loss: 0.1920, Train Acc: 0.9337, Val Loss: 0.2928, Val Acc: 0.9065
  ✅ New best model saved with val_acc: 0.9065
Epoch 10/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1738, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.87it/s]
Epoch 10: Train Loss: 0.1766, Train Acc: 0.9387, Val Loss: 0.2754, Val Acc: 0.9121
  ✅ New best model saved with val_acc: 0.9121
Epoch 11/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.1566, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.86it/s]
Epoch 11: Train Loss: 0.1673, Train Acc: 0.9421, Val Loss: 0.3201, Val Acc: 0.9003
Epoch 12/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.2565, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 12: Train Loss: 0.1571, Train Acc: 0.9453, Val Loss: 0.2867, Val Acc: 0.9127
  ✅ New best model saved with val_acc: 0.9127
Epoch 13/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1267, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 13: Train Loss: 0.1422, Train Acc: 0.9515, Val Loss: 0.2790, Val Acc: 0.9130
  ✅ New best model saved with val_acc: 0.9130
Epoch 14/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0688, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.61it/s]
Epoch 14: Train Loss: 0.1412, Train Acc: 0.9503, Val Loss: 0.3212, Val Acc: 0.9019
Epoch 15/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1645, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 15: Train Loss: 0.1335, Train Acc: 0.9540, Val Loss: 0.2877, Val Acc: 0.9148
  ✅ New best model saved with val_acc: 0.9148
Epoch 16/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0952, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 16: Train Loss: 0.1223, Train Acc: 0.9579, Val Loss: 0.2913, Val Acc: 0.9101
Epoch 17/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0893, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 17: Train Loss: 0.1167, Train Acc: 0.9604, Val Loss: 0.2823, Val Acc: 0.9186
  ✅ New best model saved with val_acc: 0.9186
Epoch 18/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1288, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 18: Train Loss: 0.1128, Train Acc: 0.9607, Val Loss: 0.2736, Val Acc: 0.9187
  ✅ New best model saved with val_acc: 0.9187
Epoch 19/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0484, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.65it/s]
Epoch 19: Train Loss: 0.1096, Train Acc: 0.9613, Val Loss: 0.2783, Val Acc: 0.9198
  ✅ New best model saved with val_acc: 0.9198
Epoch 20/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1019, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.95it/s]
Epoch 20: Train Loss: 0.0952, Train Acc: 0.9673, Val Loss: 0.3114, Val Acc: 0.9141
Epoch 21/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0490, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 21: Train Loss: 0.0960, Train Acc: 0.9668, Val Loss: 0.2762, Val Acc: 0.9160
Epoch 22/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.1317, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.97it/s]
Epoch 22: Train Loss: 0.0927, Train Acc: 0.9676, Val Loss: 0.2598, Val Acc: 0.9255
  ✅ New best model saved with val_acc: 0.9255
Epoch 23/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0996, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.03it/s]
Epoch 23: Train Loss: 0.0880, Train Acc: 0.9695, Val Loss: 0.2663, Val Acc: 0.9236
Epoch 24/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.1946, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 24: Train Loss: 0.0806, Train Acc: 0.9721, Val Loss: 0.2648, Val Acc: 0.9228
Epoch 25/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1586, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 25: Train Loss: 0.0758, Train Acc: 0.9738, Val Loss: 0.3216, Val Acc: 0.9180
Epoch 26/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0722, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 26: Train Loss: 0.0781, Train Acc: 0.9725, Val Loss: 0.3071, Val Acc: 0.9184
Epoch 27/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0312, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 27: Train Loss: 0.0704, Train Acc: 0.9760, Val Loss: 0.2641, Val Acc: 0.9263
  ✅ New best model saved with val_acc: 0.9263
Epoch 28/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0194, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 28: Train Loss: 0.0697, Train Acc: 0.9762, Val Loss: 0.3223, Val Acc: 0.9150
Epoch 29/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0841, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 29: Train Loss: 0.0663, Train Acc: 0.9768, Val Loss: 0.3202, Val Acc: 0.9195
Epoch 30/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1089, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 30: Train Loss: 0.0641, Train Acc: 0.9772, Val Loss: 0.2855, Val Acc: 0.9280
  ✅ New best model saved with val_acc: 0.9280
Epoch 31/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.1279, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 31: Train Loss: 0.0602, Train Acc: 0.9790, Val Loss: 0.2673, Val Acc: 0.9296
  ✅ New best model saved with val_acc: 0.9296
Epoch 32/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0839, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 32: Train Loss: 0.0564, Train Acc: 0.9812, Val Loss: 0.2954, Val Acc: 0.9241
Epoch 33/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.1443, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.79it/s]
Epoch 33: Train Loss: 0.0559, Train Acc: 0.9807, Val Loss: 0.3171, Val Acc: 0.9193
Epoch 34/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0907, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 34: Train Loss: 0.0566, Train Acc: 0.9809, Val Loss: 0.2677, Val Acc: 0.9265
Epoch 35/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0300, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 35: Train Loss: 0.0521, Train Acc: 0.9817, Val Loss: 0.3314, Val Acc: 0.9221
Epoch 36/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0219, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 36: Train Loss: 0.0504, Train Acc: 0.9827, Val Loss: 0.2782, Val Acc: 0.9285
Epoch 37/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0189, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 37: Train Loss: 0.0467, Train Acc: 0.9842, Val Loss: 0.3030, Val Acc: 0.9278
Epoch 38/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.1296, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.02it/s]
Epoch 38: Train Loss: 0.0438, Train Acc: 0.9851, Val Loss: 0.2894, Val Acc: 0.9294
Epoch 39/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0383, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.88it/s]
Epoch 39: Train Loss: 0.0469, Train Acc: 0.9845, Val Loss: 0.2716, Val Acc: 0.9327
  ✅ New best model saved with val_acc: 0.9327
Epoch 40/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0202, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 40: Train Loss: 0.0394, Train Acc: 0.9861, Val Loss: 0.2985, Val Acc: 0.9287
Epoch 41/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0273, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.75it/s]
Epoch 41: Train Loss: 0.0403, Train Acc: 0.9859, Val Loss: 0.3043, Val Acc: 0.9254
Epoch 42/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0595, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.96it/s]
Epoch 42: Train Loss: 0.0389, Train Acc: 0.9873, Val Loss: 0.2937, Val Acc: 0.9295
Epoch 43/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0046, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 43: Train Loss: 0.0360, Train Acc: 0.9873, Val Loss: 0.2924, Val Acc: 0.9309
Epoch 44/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0127, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 44: Train Loss: 0.0341, Train Acc: 0.9883, Val Loss: 0.3073, Val Acc: 0.9244
Epoch 45/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0198, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.94it/s]
Epoch 45: Train Loss: 0.0330, Train Acc: 0.9884, Val Loss: 0.3049, Val Acc: 0.9275
Epoch 46/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0380, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 46: Train Loss: 0.0306, Train Acc: 0.9895, Val Loss: 0.3030, Val Acc: 0.9309
Epoch 47/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0291, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 47: Train Loss: 0.0317, Train Acc: 0.9888, Val Loss: 0.2861, Val Acc: 0.9344
  ✅ New best model saved with val_acc: 0.9344
Epoch 48/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0088, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.57it/s]
Epoch 48: Train Loss: 0.0275, Train Acc: 0.9903, Val Loss: 0.2950, Val Acc: 0.9348
  ✅ New best model saved with val_acc: 0.9348
Epoch 49/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0117, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.83it/s]
Epoch 49: Train Loss: 0.0256, Train Acc: 0.9914, Val Loss: 0.2838, Val Acc: 0.9374
  ✅ New best model saved with val_acc: 0.9374
Epoch 50/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0673, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 50: Train Loss: 0.0261, Train Acc: 0.9910, Val Loss: 0.3050, Val Acc: 0.9288
Epoch 51/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0115, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 51: Train Loss: 0.0238, Train Acc: 0.9918, Val Loss: 0.2906, Val Acc: 0.9365
Epoch 52/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0427, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 52: Train Loss: 0.0224, Train Acc: 0.9925, Val Loss: 0.3017, Val Acc: 0.9329
Epoch 53/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0011, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 53: Train Loss: 0.0221, Train Acc: 0.9925, Val Loss: 0.3017, Val Acc: 0.9344
Epoch 54/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0238, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 54: Train Loss: 0.0179, Train Acc: 0.9940, Val Loss: 0.2946, Val Acc: 0.9362
Epoch 55/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0034, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 55: Train Loss: 0.0182, Train Acc: 0.9940, Val Loss: 0.3106, Val Acc: 0.9327
Epoch 56/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0117, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 56: Train Loss: 0.0177, Train Acc: 0.9939, Val Loss: 0.3016, Val Acc: 0.9396
  ✅ New best model saved with val_acc: 0.9396
Epoch 57/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0496, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.84it/s]
Epoch 57: Train Loss: 0.0177, Train Acc: 0.9940, Val Loss: 0.3268, Val Acc: 0.9315
Epoch 58/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0711, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 58: Train Loss: 0.0168, Train Acc: 0.9944, Val Loss: 0.2927, Val Acc: 0.9382
Epoch 59/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0104, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.08it/s]
Epoch 59: Train Loss: 0.0152, Train Acc: 0.9952, Val Loss: 0.2908, Val Acc: 0.9404
  ✅ New best model saved with val_acc: 0.9404
Epoch 60/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0114, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 60: Train Loss: 0.0123, Train Acc: 0.9959, Val Loss: 0.2863, Val Acc: 0.9421
  ✅ New best model saved with val_acc: 0.9421
Epoch 61/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0018, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 61: Train Loss: 0.0150, Train Acc: 0.9949, Val Loss: 0.3259, Val Acc: 0.9392
Epoch 62/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0184, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 62: Train Loss: 0.0116, Train Acc: 0.9959, Val Loss: 0.2908, Val Acc: 0.9390
Epoch 63/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0060, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 63: Train Loss: 0.0102, Train Acc: 0.9966, Val Loss: 0.2847, Val Acc: 0.9415
Epoch 64/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0015, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 64: Train Loss: 0.0098, Train Acc: 0.9968, Val Loss: 0.2806, Val Acc: 0.9392
Epoch 65/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0005, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 65: Train Loss: 0.0100, Train Acc: 0.9965, Val Loss: 0.3330, Val Acc: 0.9364
Epoch 66/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0024, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 66: Train Loss: 0.0082, Train Acc: 0.9974, Val Loss: 0.3183, Val Acc: 0.9400
Epoch 67/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0078, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.93it/s]
Epoch 67: Train Loss: 0.0064, Train Acc: 0.9978, Val Loss: 0.3166, Val Acc: 0.9418
Epoch 68/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0017, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.69it/s]
Epoch 68: Train Loss: 0.0075, Train Acc: 0.9974, Val Loss: 0.3393, Val Acc: 0.9385
Epoch 69/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0016, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 69: Train Loss: 0.0071, Train Acc: 0.9976, Val Loss: 0.3201, Val Acc: 0.9420
Epoch 70/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0001, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 70: Train Loss: 0.0051, Train Acc: 0.9984, Val Loss: 0.3222, Val Acc: 0.9431
  ✅ New best model saved with val_acc: 0.9431
Epoch 71/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0012, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.79it/s]
Epoch 71: Train Loss: 0.0064, Train Acc: 0.9979, Val Loss: 0.3099, Val Acc: 0.9420
Epoch 72/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0021, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.94it/s]
Epoch 72: Train Loss: 0.0047, Train Acc: 0.9984, Val Loss: 0.3119, Val Acc: 0.9437
  ✅ New best model saved with val_acc: 0.9437
Epoch 73/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0022, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.85it/s]
Epoch 73: Train Loss: 0.0040, Train Acc: 0.9986, Val Loss: 0.3187, Val Acc: 0.9442
  ✅ New best model saved with val_acc: 0.9442
Epoch 74/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0003, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.87it/s]
Epoch 74: Train Loss: 0.0037, Train Acc: 0.9987, Val Loss: 0.3214, Val Acc: 0.9453
  ✅ New best model saved with val_acc: 0.9453
Epoch 75/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0074, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 75: Train Loss: 0.0030, Train Acc: 0.9990, Val Loss: 0.3304, Val Acc: 0.9427
Epoch 76/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0330, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.03it/s]
Epoch 76: Train Loss: 0.0041, Train Acc: 0.9988, Val Loss: 0.3180, Val Acc: 0.9446
Epoch 77/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.79it/s, loss=0.0092, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.92it/s]
Epoch 77: Train Loss: 0.0031, Train Acc: 0.9992, Val Loss: 0.2955, Val Acc: 0.9479
  ✅ New best model saved with val_acc: 0.9479
Epoch 78/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.82it/s, loss=0.0001, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 78: Train Loss: 0.0022, Train Acc: 0.9993, Val Loss: 0.3047, Val Acc: 0.9460
Epoch 79/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0001, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 79: Train Loss: 0.0021, Train Acc: 0.9995, Val Loss: 0.3042, Val Acc: 0.9478
Epoch 80/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0113, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 80: Train Loss: 0.0021, Train Acc: 0.9994, Val Loss: 0.3096, Val Acc: 0.9482
  ✅ New best model saved with val_acc: 0.9482
Epoch 81/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.07it/s]
Epoch 81: Train Loss: 0.0016, Train Acc: 0.9996, Val Loss: 0.3177, Val Acc: 0.9485
  ✅ New best model saved with val_acc: 0.9485
Epoch 82/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0001, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 82: Train Loss: 0.0014, Train Acc: 0.9997, Val Loss: 0.3164, Val Acc: 0.9467
Epoch 83/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.88it/s]
Epoch 83: Train Loss: 0.0016, Train Acc: 0.9995, Val Loss: 0.3128, Val Acc: 0.9480
Epoch 84/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0000, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 84: Train Loss: 0.0013, Train Acc: 0.9996, Val Loss: 0.3074, Val Acc: 0.9489
  ✅ New best model saved with val_acc: 0.9489
Epoch 85/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.08it/s]
Epoch 85: Train Loss: 0.0009, Train Acc: 0.9998, Val Loss: 0.3085, Val Acc: 0.9480
Epoch 86/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.82it/s, loss=0.0004, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 86: Train Loss: 0.0009, Train Acc: 0.9997, Val Loss: 0.3107, Val Acc: 0.9501
  ✅ New best model saved with val_acc: 0.9501
Epoch 87/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0000, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 87: Train Loss: 0.0009, Train Acc: 0.9997, Val Loss: 0.3138, Val Acc: 0.9490
Epoch 88/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0000, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.77it/s]
Epoch 88: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3149, Val Acc: 0.9497
Epoch 89/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0000, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 89: Train Loss: 0.0007, Train Acc: 0.9998, Val Loss: 0.3137, Val Acc: 0.9485
Epoch 90/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.80it/s, loss=0.0001, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 90: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3081, Val Acc: 0.9498
Epoch 91/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.02it/s]
Epoch 91: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3079, Val Acc: 0.9520
  ✅ New best model saved with val_acc: 0.9520
Epoch 92/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 92: Train Loss: 0.0006, Train Acc: 0.9998, Val Loss: 0.3064, Val Acc: 0.9513
Epoch 93/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.82it/s, loss=0.0002, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 93: Train Loss: 0.0003, Train Acc: 0.9999, Val Loss: 0.3097, Val Acc: 0.9513
Epoch 94/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 94: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3048, Val Acc: 0.9522
  ✅ New best model saved with val_acc: 0.9522
Epoch 95/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0032, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 95: Train Loss: 0.0003, Train Acc: 0.9999, Val Loss: 0.3058, Val Acc: 0.9524
  ✅ New best model saved with val_acc: 0.9524
Epoch 96/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0000, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 96: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3058, Val Acc: 0.9518
Epoch 97/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.82it/s, loss=0.0000, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 97: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3053, Val Acc: 0.9517
Epoch 98/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0000, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 98: Train Loss: 0.0003, Train Acc: 0.9999, Val Loss: 0.3045, Val Acc: 0.9519
Epoch 99/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.82it/s, loss=0.0002, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 99: Train Loss: 0.0002, Train Acc: 1.0000, Val Loss: 0.3050, Val Acc: 0.9522
Epoch 100/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.81it/s, loss=0.0001, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 100: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3050, Val Acc: 0.9523
✅ Training completed. Best validation accuracy: 0.9524

=== TRAINING TTT MODELS ===
✅ Loaded base model for TTT training

🚀 Training TTT model on CIFAR-10...
TTT Epoch 1/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 1: Train Loss: 1.3077, Val Loss: 1.2023
TTT Epoch 2/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.07it/s]
TTT Epoch 2: Train Loss: 0.8765, Val Loss: 0.8057
TTT Epoch 3/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.07it/s]
TTT Epoch 3: Train Loss: 0.7354, Val Loss: 0.7008
TTT Epoch 4/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 4: Train Loss: 0.6970, Val Loss: 0.6534
TTT Epoch 5/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 5: Train Loss: 0.6780, Val Loss: 0.6400
TTT Epoch 6/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 6: Train Loss: 0.6613, Val Loss: 0.6272
TTT Epoch 7/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 7: Train Loss: 0.6467, Val Loss: 0.6362
TTT Epoch 8/50: 100%|█████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 8: Train Loss: 0.6462, Val Loss: 0.6154
TTT Epoch 9/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 9: Train Loss: 0.6245, Val Loss: 0.6131
TTT Epoch 10/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 10: Train Loss: 0.6201, Val Loss: 0.5992
TTT Epoch 11/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 11: Train Loss: 0.6069, Val Loss: 0.5887
TTT Epoch 12/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.10it/s]
TTT Epoch 12: Train Loss: 0.6000, Val Loss: 0.5885
TTT Epoch 13/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 13: Train Loss: 0.5951, Val Loss: 0.5840
TTT Epoch 14/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 14: Train Loss: 0.5908, Val Loss: 0.5687
TTT Epoch 15/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 15: Train Loss: 0.5923, Val Loss: 0.5996
TTT Epoch 16/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 16: Train Loss: 0.5835, Val Loss: 0.5881
TTT Epoch 17/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 17: Train Loss: 0.5733, Val Loss: 0.5726
TTT Epoch 18/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 18: Train Loss: 0.5728, Val Loss: 0.5619
TTT Epoch 19/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 19: Train Loss: 0.5671, Val Loss: 0.5843
TTT Epoch 20/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 20: Train Loss: 0.5667, Val Loss: 0.5547
TTT Epoch 21/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 21: Train Loss: 0.5659, Val Loss: 0.5401
TTT Epoch 22/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 22: Train Loss: 0.5617, Val Loss: 0.5518
TTT Epoch 23/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 23: Train Loss: 0.5589, Val Loss: 0.5437
TTT Epoch 24/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 24: Train Loss: 0.5584, Val Loss: 0.5361
TTT Epoch 25/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 25: Train Loss: 0.5519, Val Loss: 0.5263
TTT Epoch 26/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 26: Train Loss: 0.5518, Val Loss: 0.5441
TTT Epoch 27/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 27: Train Loss: 0.5490, Val Loss: 0.5222
TTT Epoch 28/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.10it/s]
TTT Epoch 28: Train Loss: 0.5390, Val Loss: 0.5238
TTT Epoch 29/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 29: Train Loss: 0.5423, Val Loss: 0.5431
TTT Epoch 30/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 30: Train Loss: 0.5461, Val Loss: 0.5222
TTT Epoch 31/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 31: Train Loss: 0.5342, Val Loss: 0.5181
TTT Epoch 32/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 32: Train Loss: 0.5327, Val Loss: 0.5258
TTT Epoch 33/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 33: Train Loss: 0.5293, Val Loss: 0.5319
TTT Epoch 34/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 34: Train Loss: 0.5267, Val Loss: 0.5304
TTT Epoch 35/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.07it/s]
TTT Epoch 35: Train Loss: 0.5245, Val Loss: 0.5079
TTT Epoch 36/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 36: Train Loss: 0.5226, Val Loss: 0.5213
TTT Epoch 37/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 37: Train Loss: 0.5208, Val Loss: 0.5128
TTT Epoch 38/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 38: Train Loss: 0.5219, Val Loss: 0.5265
TTT Epoch 39/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 39: Train Loss: 0.5128, Val Loss: 0.5407
TTT Epoch 40/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.07it/s]
TTT Epoch 40: Train Loss: 0.5183, Val Loss: 0.5107
TTT Epoch 41/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 41: Train Loss: 0.5130, Val Loss: 0.5086
TTT Epoch 42/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 42: Train Loss: 0.5143, Val Loss: 0.4940
TTT Epoch 43/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 43: Train Loss: 0.5125, Val Loss: 0.4976
TTT Epoch 44/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 44: Train Loss: 0.5082, Val Loss: 0.5278
TTT Epoch 45/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 45: Train Loss: 0.5121, Val Loss: 0.4900
TTT Epoch 46/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.10it/s]
TTT Epoch 46: Train Loss: 0.5040, Val Loss: 0.5034
TTT Epoch 47/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 47: Train Loss: 0.5027, Val Loss: 0.4936
TTT Epoch 48/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.08it/s]
TTT Epoch 48: Train Loss: 0.5030, Val Loss: 0.5005
TTT Epoch 49/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.09it/s]
TTT Epoch 49: Train Loss: 0.4997, Val Loss: 0.4981
TTT Epoch 50/50: 100%|████████████████████████| 391/391 [00:43<00:00,  9.09it/s]
TTT Epoch 50: Train Loss: 0.4965, Val Loss: 0.4914

🚀 Training TTT3fc model on CIFAR-10...
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1025, in <module>
    main()
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 994, in main
    train_ttt_models(train_loader, val_loader)
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 431, in train_ttt_models
    train_ttt3fc_model(
TypeError: train_ttt3fc_model() got an unexpected keyword argument 'model_save_dir'
