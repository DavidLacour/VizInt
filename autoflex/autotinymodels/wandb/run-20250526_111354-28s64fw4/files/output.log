✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000
✅ Loaded CIFAR-10 dataset (without normalization)
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

✓ Main ViT model already exists at ../../cifar10checkpoints/bestmodel_main/best_model.pt

=== TRAINING ROBUST VIT MODEL ===

🚀 Training robust ViT model on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [01:12<00:00,  5.37it/s, loss=2.1641, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 16.36it/s]
Epoch 1: Train Loss: 2.3386, Train Acc: 0.1491, Val Loss: 1.9751, Val Acc: 0.2262
  ✅ New best model saved with val_acc: 0.2262
Epoch 2/100 [Train]: 100%|█| 391/391 [01:24<00:00,  4.63it/s, loss=2.2086, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 15.91it/s]
Epoch 2: Train Loss: 2.1060, Train Acc: 0.1941, Val Loss: 1.9192, Val Acc: 0.2637
  ✅ New best model saved with val_acc: 0.2637
Epoch 3/100 [Train]: 100%|█| 391/391 [01:26<00:00,  4.52it/s, loss=2.0924, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 15.90it/s]
Epoch 3: Train Loss: 2.0520, Train Acc: 0.2172, Val Loss: 1.9057, Val Acc: 0.2481
  No improvement for 1 epochs
Epoch 4/100 [Train]: 100%|█| 391/391 [01:25<00:00,  4.59it/s, loss=2.1557, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:05<00:00, 15.29it/s]
Epoch 4: Train Loss: 2.0277, Train Acc: 0.2309, Val Loss: 1.8450, Val Acc: 0.2904
  ✅ New best model saved with val_acc: 0.2904
Epoch 5/100 [Train]: 100%|█| 391/391 [01:25<00:00,  4.55it/s, loss=2.1360, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:05<00:00, 15.26it/s]
Epoch 5: Train Loss: 2.0543, Train Acc: 0.2181, Val Loss: 2.0038, Val Acc: 0.2407
  No improvement for 1 epochs
Epoch 6/100 [Train]: 100%|█| 391/391 [01:27<00:00,  4.45it/s, loss=2.0067, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:05<00:00, 15.43it/s]
Epoch 6: Train Loss: 2.0988, Train Acc: 0.1993, Val Loss: 1.9306, Val Acc: 0.2509
  No improvement for 2 epochs
Epoch 7/100 [Train]: 100%|█| 391/391 [01:17<00:00,  5.04it/s, loss=2.1403, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 17.41it/s]
Epoch 7: Train Loss: 2.0653, Train Acc: 0.2124, Val Loss: 1.9799, Val Acc: 0.2517
  No improvement for 3 epochs
Epoch 8/100 [Train]: 100%|█| 391/391 [01:12<00:00,  5.39it/s, loss=2.0422, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 17.82it/s]
Epoch 8: Train Loss: 2.0549, Train Acc: 0.2151, Val Loss: 1.8375, Val Acc: 0.2880
  No improvement for 4 epochs
Epoch 9/100 [Train]: 100%|█| 391/391 [01:12<00:00,  5.39it/s, loss=1.8884, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:04<00:00, 16.68it/s]
Epoch 9: Train Loss: 2.0272, Train Acc: 0.2260, Val Loss: 1.8543, Val Acc: 0.2879
  No improvement for 5 epochs
  🛑 Early stopping triggered after 9 epochs
  Best validation accuracy: 0.2904
✅ Training completed. Best validation accuracy: 0.2904

=== TRAINING RESNET BASELINE (from scratch) ===
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)

🚀 Training resnet18_baseline on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [00:28<00:00, 13.93it/s, loss=0.9764, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 45.82it/s]
Epoch 1: Train Loss: 1.3582, Train Acc: 0.5033, Val Loss: 1.3219, Val Acc: 0.5738
  ✅ New best model saved with val_acc: 0.5738
Epoch 2/100 [Train]: 100%|█| 391/391 [00:28<00:00, 13.64it/s, loss=0.7155, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 45.28it/s]
Epoch 2: Train Loss: 0.8866, Train Acc: 0.6834, Val Loss: 0.9264, Val Acc: 0.6938
  ✅ New best model saved with val_acc: 0.6938
Epoch 3/100 [Train]: 100%|█| 391/391 [00:29<00:00, 13.42it/s, loss=0.5521, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 44.65it/s]
Epoch 3: Train Loss: 0.6852, Train Acc: 0.7602, Val Loss: 0.6735, Val Acc: 0.7747
  ✅ New best model saved with val_acc: 0.7747
Epoch 4/100 [Train]:  12%| | 48/391 [00:03<00:26, 12.95it/s, loss=0.6345, acc=0.
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1763, in <module>
    patience_counter += 1
    ^^^^^^
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1698, in main
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 371, in train_resnet_baseline
KeyboardInterrupt
