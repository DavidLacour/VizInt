✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

✓ Main ViT model already exists at ../../cifar10checkpoints/bestmodel_main/best_model.pt

✓ Robust ViT model already exists at ../../cifar10checkpoints/bestmodel_robust/best_model.pt

=== TRAINING RESNET BASELINE (from scratch) ===
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)

🚀 Training resnet18_baseline on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [00:33<00:00, 11.55it/s, loss=0.9250, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:02<00:00, 39.17it/s]
Epoch 1: Train Loss: 1.3515, Train Acc: 0.5068, Val Loss: 1.6298, Val Acc: 0.5151
  ✅ New best model saved with val_acc: 0.5151
Epoch 2/100 [Train]: 100%|█| 391/391 [00:33<00:00, 11.64it/s, loss=0.4972, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 39.56it/s]
Epoch 2: Train Loss: 0.8687, Train Acc: 0.6925, Val Loss: 1.0610, Val Acc: 0.6467
  ✅ New best model saved with val_acc: 0.6467
Epoch 3/100 [Train]: 100%|█| 391/391 [00:27<00:00, 14.06it/s, loss=0.6837, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.02it/s]
Epoch 3: Train Loss: 0.6796, Train Acc: 0.7638, Val Loss: 0.6922, Val Acc: 0.7654
  ✅ New best model saved with val_acc: 0.7654
Epoch 4/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.99it/s, loss=0.5338, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.69it/s]
Epoch 4: Train Loss: 0.5753, Train Acc: 0.7995, Val Loss: 0.5636, Val Acc: 0.8108
  ✅ New best model saved with val_acc: 0.8108
Epoch 5/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.5593, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 5: Train Loss: 0.5128, Train Acc: 0.8228, Val Loss: 0.6671, Val Acc: 0.7916
Epoch 6/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.89it/s, loss=0.5387, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 6: Train Loss: 0.4468, Train Acc: 0.8455, Val Loss: 0.5515, Val Acc: 0.8159
  ✅ New best model saved with val_acc: 0.8159
Epoch 7/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.3081, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.55it/s]
Epoch 7: Train Loss: 0.4064, Train Acc: 0.8610, Val Loss: 0.5601, Val Acc: 0.8184
  ✅ New best model saved with val_acc: 0.8184
Epoch 8/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.4700, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 8: Train Loss: 0.3733, Train Acc: 0.8713, Val Loss: 0.4300, Val Acc: 0.8558
  ✅ New best model saved with val_acc: 0.8558
Epoch 9/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.3777, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.53it/s]
Epoch 9: Train Loss: 0.3365, Train Acc: 0.8831, Val Loss: 0.4029, Val Acc: 0.8650
  ✅ New best model saved with val_acc: 0.8650
Epoch 10/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.95it/s, loss=0.5808, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.52it/s]
Epoch 10: Train Loss: 0.3227, Train Acc: 0.8882, Val Loss: 0.4133, Val Acc: 0.8644
Epoch 11/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.3576, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.69it/s]
Epoch 11: Train Loss: 0.2921, Train Acc: 0.8977, Val Loss: 0.4169, Val Acc: 0.8672
  ✅ New best model saved with val_acc: 0.8672
Epoch 12/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.2112, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.63it/s]
Epoch 12: Train Loss: 0.2697, Train Acc: 0.9064, Val Loss: 0.4300, Val Acc: 0.8566
Epoch 13/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.94it/s, loss=0.3333, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.42it/s]
Epoch 13: Train Loss: 0.2535, Train Acc: 0.9113, Val Loss: 0.3846, Val Acc: 0.8787
  ✅ New best model saved with val_acc: 0.8787
Epoch 14/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.93it/s, loss=0.2324, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.56it/s]
Epoch 14: Train Loss: 0.2375, Train Acc: 0.9171, Val Loss: 0.3797, Val Acc: 0.8816
  ✅ New best model saved with val_acc: 0.8816
Epoch 15/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.93it/s, loss=0.2079, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.57it/s]
Epoch 15: Train Loss: 0.2170, Train Acc: 0.9240, Val Loss: 0.3592, Val Acc: 0.8875
  ✅ New best model saved with val_acc: 0.8875
Epoch 16/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.3364, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.43it/s]
Epoch 16: Train Loss: 0.2035, Train Acc: 0.9297, Val Loss: 0.3509, Val Acc: 0.8908
  ✅ New best model saved with val_acc: 0.8908
Epoch 17/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.1765, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 17: Train Loss: 0.1889, Train Acc: 0.9341, Val Loss: 0.3518, Val Acc: 0.8948
  ✅ New best model saved with val_acc: 0.8948
Epoch 18/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.1851, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.39it/s]
Epoch 18: Train Loss: 0.1789, Train Acc: 0.9380, Val Loss: 0.3345, Val Acc: 0.8936
Epoch 19/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.1156, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.34it/s]
Epoch 19: Train Loss: 0.1655, Train Acc: 0.9420, Val Loss: 0.3437, Val Acc: 0.8933
Epoch 20/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.91it/s, loss=0.1355, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.36it/s]
Epoch 20: Train Loss: 0.1569, Train Acc: 0.9441, Val Loss: 0.3475, Val Acc: 0.8942
Epoch 21/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.92it/s, loss=0.2098, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.32it/s]
Epoch 21: Train Loss: 0.1456, Train Acc: 0.9496, Val Loss: 0.3171, Val Acc: 0.9019
  ✅ New best model saved with val_acc: 0.9019
Epoch 22/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.91it/s, loss=0.1695, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 22: Train Loss: 0.1347, Train Acc: 0.9533, Val Loss: 0.3573, Val Acc: 0.8982
Epoch 23/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.90it/s, loss=0.1868, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.38it/s]
Epoch 23: Train Loss: 0.1293, Train Acc: 0.9534, Val Loss: 0.3826, Val Acc: 0.8920
Epoch 24/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.91it/s, loss=0.0553, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.51it/s]
Epoch 24: Train Loss: 0.1208, Train Acc: 0.9575, Val Loss: 0.3328, Val Acc: 0.9065
  ✅ New best model saved with val_acc: 0.9065
Epoch 25/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.91it/s, loss=0.1204, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 25: Train Loss: 0.1108, Train Acc: 0.9612, Val Loss: 0.3635, Val Acc: 0.9016
Epoch 26/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.90it/s, loss=0.0821, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 26: Train Loss: 0.1061, Train Acc: 0.9629, Val Loss: 0.3471, Val Acc: 0.9049
Epoch 27/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.91it/s, loss=0.1832, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 27: Train Loss: 0.0996, Train Acc: 0.9640, Val Loss: 0.3590, Val Acc: 0.9045
Epoch 28/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.90it/s, loss=0.0707, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.06it/s]
Epoch 28: Train Loss: 0.0989, Train Acc: 0.9653, Val Loss: 0.3406, Val Acc: 0.9073
  ✅ New best model saved with val_acc: 0.9073
Epoch 29/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.90it/s, loss=0.1471, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.38it/s]
Epoch 29: Train Loss: 0.0849, Train Acc: 0.9700, Val Loss: 0.3816, Val Acc: 0.9037
Epoch 30/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0638, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 30: Train Loss: 0.0863, Train Acc: 0.9704, Val Loss: 0.3706, Val Acc: 0.9051
Epoch 31/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0991, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 31: Train Loss: 0.0838, Train Acc: 0.9709, Val Loss: 0.3461, Val Acc: 0.9091
  ✅ New best model saved with val_acc: 0.9091
Epoch 32/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.89it/s, loss=0.0925, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 32: Train Loss: 0.0756, Train Acc: 0.9735, Val Loss: 0.3317, Val Acc: 0.9139
  ✅ New best model saved with val_acc: 0.9139
Epoch 33/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0670, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 33: Train Loss: 0.0719, Train Acc: 0.9748, Val Loss: 0.3524, Val Acc: 0.9094
Epoch 34/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.1129, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 34: Train Loss: 0.0714, Train Acc: 0.9748, Val Loss: 0.3517, Val Acc: 0.9157
  ✅ New best model saved with val_acc: 0.9157
Epoch 35/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0685, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.40it/s]
Epoch 35: Train Loss: 0.0606, Train Acc: 0.9792, Val Loss: 0.3633, Val Acc: 0.9100
Epoch 36/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0308, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 36: Train Loss: 0.0611, Train Acc: 0.9784, Val Loss: 0.3882, Val Acc: 0.9084
Epoch 37/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0494, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 37: Train Loss: 0.0594, Train Acc: 0.9788, Val Loss: 0.3789, Val Acc: 0.9127
Epoch 38/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0753, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.23it/s]
Epoch 38: Train Loss: 0.0606, Train Acc: 0.9785, Val Loss: 0.3910, Val Acc: 0.9031
Epoch 39/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0524, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.32it/s]
Epoch 39: Train Loss: 0.0539, Train Acc: 0.9809, Val Loss: 0.3419, Val Acc: 0.9174
  ✅ New best model saved with val_acc: 0.9174
Epoch 40/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0285, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.37it/s]
Epoch 40: Train Loss: 0.0468, Train Acc: 0.9836, Val Loss: 0.3410, Val Acc: 0.9188
  ✅ New best model saved with val_acc: 0.9188
Epoch 41/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0971, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.23it/s]
Epoch 41: Train Loss: 0.0507, Train Acc: 0.9826, Val Loss: 0.3408, Val Acc: 0.9157
Epoch 42/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.1065, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 42: Train Loss: 0.0466, Train Acc: 0.9841, Val Loss: 0.3804, Val Acc: 0.9151
Epoch 43/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0867, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.34it/s]
Epoch 43: Train Loss: 0.0429, Train Acc: 0.9847, Val Loss: 0.3527, Val Acc: 0.9174
Epoch 44/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0261, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.03it/s]
Epoch 44: Train Loss: 0.0421, Train Acc: 0.9851, Val Loss: 0.4355, Val Acc: 0.9049
Epoch 45/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0345, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 45: Train Loss: 0.0404, Train Acc: 0.9861, Val Loss: 0.3973, Val Acc: 0.9141
Epoch 46/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.88it/s, loss=0.0600, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 46: Train Loss: 0.0354, Train Acc: 0.9878, Val Loss: 0.3701, Val Acc: 0.9144
Epoch 47/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1015, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 47: Train Loss: 0.0341, Train Acc: 0.9877, Val Loss: 0.3965, Val Acc: 0.9134
Epoch 48/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0505, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.31it/s]
Epoch 48: Train Loss: 0.0355, Train Acc: 0.9877, Val Loss: 0.3769, Val Acc: 0.9208
  ✅ New best model saved with val_acc: 0.9208
Epoch 49/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0969, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 49: Train Loss: 0.0347, Train Acc: 0.9883, Val Loss: 0.3633, Val Acc: 0.9220
  ✅ New best model saved with val_acc: 0.9220
Epoch 50/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1144, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.31it/s]
Epoch 50: Train Loss: 0.0294, Train Acc: 0.9900, Val Loss: 0.3669, Val Acc: 0.9204
Epoch 51/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0149, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 51: Train Loss: 0.0287, Train Acc: 0.9898, Val Loss: 0.3545, Val Acc: 0.9241
  ✅ New best model saved with val_acc: 0.9241
Epoch 52/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0028, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 52: Train Loss: 0.0260, Train Acc: 0.9911, Val Loss: 0.3609, Val Acc: 0.9238
Epoch 53/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.1004, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 53: Train Loss: 0.0246, Train Acc: 0.9914, Val Loss: 0.3873, Val Acc: 0.9211
Epoch 54/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0038, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 54: Train Loss: 0.0274, Train Acc: 0.9904, Val Loss: 0.4404, Val Acc: 0.9121
Epoch 55/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0393, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 55: Train Loss: 0.0209, Train Acc: 0.9934, Val Loss: 0.4021, Val Acc: 0.9184
Epoch 56/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0025, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 56: Train Loss: 0.0231, Train Acc: 0.9920, Val Loss: 0.3978, Val Acc: 0.9223
Epoch 57/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0170, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 57: Train Loss: 0.0181, Train Acc: 0.9936, Val Loss: 0.3717, Val Acc: 0.9270
  ✅ New best model saved with val_acc: 0.9270
Epoch 58/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0624, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 58: Train Loss: 0.0193, Train Acc: 0.9934, Val Loss: 0.3589, Val Acc: 0.9235
Epoch 59/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.0020, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 59: Train Loss: 0.0169, Train Acc: 0.9942, Val Loss: 0.3752, Val Acc: 0.9267
Epoch 60/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0076, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 60: Train Loss: 0.0156, Train Acc: 0.9948, Val Loss: 0.3775, Val Acc: 0.9271
  ✅ New best model saved with val_acc: 0.9271
Epoch 61/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0017, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 61: Train Loss: 0.0140, Train Acc: 0.9954, Val Loss: 0.3811, Val Acc: 0.9240
Epoch 62/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0054, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 62: Train Loss: 0.0145, Train Acc: 0.9950, Val Loss: 0.3871, Val Acc: 0.9258
Epoch 63/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0575, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 63: Train Loss: 0.0130, Train Acc: 0.9956, Val Loss: 0.3871, Val Acc: 0.9291
  ✅ New best model saved with val_acc: 0.9291
Epoch 64/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0123, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 64: Train Loss: 0.0123, Train Acc: 0.9959, Val Loss: 0.4094, Val Acc: 0.9216
Epoch 65/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0176, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 65: Train Loss: 0.0103, Train Acc: 0.9964, Val Loss: 0.3742, Val Acc: 0.9298
  ✅ New best model saved with val_acc: 0.9298
Epoch 66/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0088, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 66: Train Loss: 0.0102, Train Acc: 0.9964, Val Loss: 0.4041, Val Acc: 0.9262
Epoch 67/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0070, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 67: Train Loss: 0.0097, Train Acc: 0.9966, Val Loss: 0.3839, Val Acc: 0.9304
  ✅ New best model saved with val_acc: 0.9304
Epoch 68/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0077, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 68: Train Loss: 0.0083, Train Acc: 0.9970, Val Loss: 0.3853, Val Acc: 0.9295
Epoch 69/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0221, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.01it/s]
Epoch 69: Train Loss: 0.0079, Train Acc: 0.9974, Val Loss: 0.3908, Val Acc: 0.9284
Epoch 70/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0013, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.85it/s]
Epoch 70: Train Loss: 0.0058, Train Acc: 0.9982, Val Loss: 0.3774, Val Acc: 0.9292
Epoch 71/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0046, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.49it/s]
Epoch 71: Train Loss: 0.0067, Train Acc: 0.9978, Val Loss: 0.4056, Val Acc: 0.9276
Epoch 72/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.0002, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 72: Train Loss: 0.0055, Train Acc: 0.9982, Val Loss: 0.3838, Val Acc: 0.9304
Epoch 73/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 73: Train Loss: 0.0050, Train Acc: 0.9984, Val Loss: 0.3891, Val Acc: 0.9311
  ✅ New best model saved with val_acc: 0.9311
Epoch 74/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0007, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 74: Train Loss: 0.0040, Train Acc: 0.9989, Val Loss: 0.3967, Val Acc: 0.9293
Epoch 75/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.83it/s]
Epoch 75: Train Loss: 0.0044, Train Acc: 0.9985, Val Loss: 0.4081, Val Acc: 0.9291
Epoch 76/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.36it/s]
Epoch 76: Train Loss: 0.0038, Train Acc: 0.9988, Val Loss: 0.3855, Val Acc: 0.9326
  ✅ New best model saved with val_acc: 0.9326
Epoch 77/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0025, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 77: Train Loss: 0.0038, Train Acc: 0.9990, Val Loss: 0.3976, Val Acc: 0.9304
Epoch 78/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 78: Train Loss: 0.0028, Train Acc: 0.9993, Val Loss: 0.3893, Val Acc: 0.9344
  ✅ New best model saved with val_acc: 0.9344
Epoch 79/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.98it/s]
Epoch 79: Train Loss: 0.0022, Train Acc: 0.9993, Val Loss: 0.3869, Val Acc: 0.9311
Epoch 80/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 80: Train Loss: 0.0022, Train Acc: 0.9994, Val Loss: 0.3912, Val Acc: 0.9337
Epoch 81/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0147, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 81: Train Loss: 0.0025, Train Acc: 0.9992, Val Loss: 0.3909, Val Acc: 0.9335
Epoch 82/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0022, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 82: Train Loss: 0.0022, Train Acc: 0.9994, Val Loss: 0.3832, Val Acc: 0.9353
  ✅ New best model saved with val_acc: 0.9353
Epoch 83/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 83: Train Loss: 0.0015, Train Acc: 0.9996, Val Loss: 0.3859, Val Acc: 0.9346
Epoch 84/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.0025, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.32it/s]
Epoch 84: Train Loss: 0.0016, Train Acc: 0.9996, Val Loss: 0.3835, Val Acc: 0.9350
Epoch 85/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0017, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 85: Train Loss: 0.0014, Train Acc: 0.9996, Val Loss: 0.3893, Val Acc: 0.9350
Epoch 86/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0000, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 86: Train Loss: 0.0011, Train Acc: 0.9997, Val Loss: 0.3930, Val Acc: 0.9345
Epoch 87/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 87: Train Loss: 0.0011, Train Acc: 0.9997, Val Loss: 0.3853, Val Acc: 0.9373
  ✅ New best model saved with val_acc: 0.9373
Epoch 88/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 88: Train Loss: 0.0010, Train Acc: 0.9998, Val Loss: 0.3874, Val Acc: 0.9367
Epoch 89/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0030, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.90it/s]
Epoch 89: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3828, Val Acc: 0.9373
Epoch 90/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0014, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 90: Train Loss: 0.0009, Train Acc: 0.9997, Val Loss: 0.3830, Val Acc: 0.9368
Epoch 91/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 91: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3835, Val Acc: 0.9362
Epoch 92/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.95it/s]
Epoch 92: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3838, Val Acc: 0.9369
Epoch 93/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 93: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3845, Val Acc: 0.9363
Epoch 94/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0000, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 94: Train Loss: 0.0005, Train Acc: 0.9998, Val Loss: 0.3852, Val Acc: 0.9365
Epoch 95/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0010, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.99it/s]
Epoch 95: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3795, Val Acc: 0.9379
  ✅ New best model saved with val_acc: 0.9379
Epoch 96/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0106, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 96: Train Loss: 0.0005, Train Acc: 0.9998, Val Loss: 0.3856, Val Acc: 0.9370
Epoch 97/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0020, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.09it/s]
Epoch 97: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3808, Val Acc: 0.9369
Epoch 98/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 98: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3838, Val Acc: 0.9372
Epoch 99/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 99: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3855, Val Acc: 0.9369
Epoch 100/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0003, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:01<00:00, 51.20it/s]
Epoch 100: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3814, Val Acc: 0.9376
✅ Training completed. Best validation accuracy: 0.9379

=== TRAINING RESNET BASELINE (pretrained) ===
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)

🚀 Training resnet18_pretrained on CIFAR-10...
Epoch 1/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.84it/s, loss=0.6781, acc=0
Epoch 1/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.78it/s]
Epoch 1: Train Loss: 0.8178, Train Acc: 0.7171, Val Loss: 0.7827, Val Acc: 0.7527
  ✅ New best model saved with val_acc: 0.7527
Epoch 2/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.84it/s, loss=0.4671, acc=0
Epoch 2/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.32it/s]
Epoch 2: Train Loss: 0.4822, Train Acc: 0.8376, Val Loss: 0.4625, Val Acc: 0.8454
  ✅ New best model saved with val_acc: 0.8454
Epoch 3/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.3788, acc=0
Epoch 3/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.13it/s]
Epoch 3: Train Loss: 0.3831, Train Acc: 0.8696, Val Loss: 0.4292, Val Acc: 0.8598
  ✅ New best model saved with val_acc: 0.8598
Epoch 4/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.84it/s, loss=0.4235, acc=0
Epoch 4/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 4: Train Loss: 0.3293, Train Acc: 0.8870, Val Loss: 0.3849, Val Acc: 0.8716
  ✅ New best model saved with val_acc: 0.8716
Epoch 5/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.3336, acc=0
Epoch 5/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.34it/s]
Epoch 5: Train Loss: 0.2869, Train Acc: 0.9009, Val Loss: 0.3999, Val Acc: 0.8690
Epoch 6/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.2943, acc=0
Epoch 6/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 6: Train Loss: 0.2626, Train Acc: 0.9106, Val Loss: 0.4092, Val Acc: 0.8747
  ✅ New best model saved with val_acc: 0.8747
Epoch 7/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.2353, acc=0
Epoch 7/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 50.91it/s]
Epoch 7: Train Loss: 0.2377, Train Acc: 0.9183, Val Loss: 0.3161, Val Acc: 0.8982
  ✅ New best model saved with val_acc: 0.8982
Epoch 8/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1989, acc=0
Epoch 8/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.35it/s]
Epoch 8: Train Loss: 0.2168, Train Acc: 0.9261, Val Loss: 0.2662, Val Acc: 0.9134
  ✅ New best model saved with val_acc: 0.9134
Epoch 9/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1871, acc=0
Epoch 9/100 [Val]: 100%|████████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 9: Train Loss: 0.1977, Train Acc: 0.9319, Val Loss: 0.2892, Val Acc: 0.9088
Epoch 10/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.1402, acc=
Epoch 10/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 10: Train Loss: 0.1845, Train Acc: 0.9357, Val Loss: 0.3166, Val Acc: 0.9022
Epoch 11/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1776, acc=
Epoch 11/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 11: Train Loss: 0.1765, Train Acc: 0.9392, Val Loss: 0.2816, Val Acc: 0.9104
Epoch 12/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1828, acc=
Epoch 12/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 12: Train Loss: 0.1605, Train Acc: 0.9442, Val Loss: 0.2984, Val Acc: 0.9111
Epoch 13/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.2674, acc=
Epoch 13/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.60it/s]
Epoch 13: Train Loss: 0.1552, Train Acc: 0.9464, Val Loss: 0.2961, Val Acc: 0.9066
Epoch 14/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1328, acc=
Epoch 14/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.11it/s]
Epoch 14: Train Loss: 0.1366, Train Acc: 0.9526, Val Loss: 0.3323, Val Acc: 0.9025
Epoch 15/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1842, acc=
Epoch 15/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 15: Train Loss: 0.1368, Train Acc: 0.9525, Val Loss: 0.3190, Val Acc: 0.9075
Epoch 16/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.3342, acc=
Epoch 16/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 16: Train Loss: 0.1267, Train Acc: 0.9569, Val Loss: 0.2835, Val Acc: 0.9128
Epoch 17/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.2119, acc=
Epoch 17/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 17: Train Loss: 0.1233, Train Acc: 0.9573, Val Loss: 0.2750, Val Acc: 0.9144
  ✅ New best model saved with val_acc: 0.9144
Epoch 18/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.2517, acc=
Epoch 18/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 18: Train Loss: 0.1105, Train Acc: 0.9609, Val Loss: 0.2915, Val Acc: 0.9128
Epoch 19/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1087, acc=
Epoch 19/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 19: Train Loss: 0.1099, Train Acc: 0.9628, Val Loss: 0.2865, Val Acc: 0.9174
  ✅ New best model saved with val_acc: 0.9174
Epoch 20/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.1654, acc=
Epoch 20/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 20: Train Loss: 0.1038, Train Acc: 0.9637, Val Loss: 0.2767, Val Acc: 0.9211
  ✅ New best model saved with val_acc: 0.9211
Epoch 21/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1435, acc=
Epoch 21/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.24it/s]
Epoch 21: Train Loss: 0.0955, Train Acc: 0.9679, Val Loss: 0.3259, Val Acc: 0.9109
Epoch 22/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0265, acc=
Epoch 22/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.96it/s]
Epoch 22: Train Loss: 0.0913, Train Acc: 0.9688, Val Loss: 0.2986, Val Acc: 0.9183
Epoch 23/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0982, acc=
Epoch 23/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 23: Train Loss: 0.0907, Train Acc: 0.9686, Val Loss: 0.2795, Val Acc: 0.9221
  ✅ New best model saved with val_acc: 0.9221
Epoch 24/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0626, acc=
Epoch 24/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.15it/s]
Epoch 24: Train Loss: 0.0833, Train Acc: 0.9714, Val Loss: 0.3197, Val Acc: 0.9141
Epoch 25/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0627, acc=
Epoch 25/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 25: Train Loss: 0.0805, Train Acc: 0.9723, Val Loss: 0.2905, Val Acc: 0.9211
Epoch 26/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0991, acc=
Epoch 26/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 26: Train Loss: 0.0797, Train Acc: 0.9722, Val Loss: 0.3217, Val Acc: 0.9123
Epoch 27/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0316, acc=
Epoch 27/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 27: Train Loss: 0.0711, Train Acc: 0.9762, Val Loss: 0.3358, Val Acc: 0.9106
Epoch 28/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0231, acc=
Epoch 28/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 28: Train Loss: 0.0728, Train Acc: 0.9748, Val Loss: 0.2927, Val Acc: 0.9193
Epoch 29/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.85it/s, loss=0.0248, acc=
Epoch 29/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.23it/s]
Epoch 29: Train Loss: 0.0657, Train Acc: 0.9781, Val Loss: 0.2942, Val Acc: 0.9209
Epoch 30/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0606, acc=
Epoch 30/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 30: Train Loss: 0.0681, Train Acc: 0.9765, Val Loss: 0.2826, Val Acc: 0.9194
Epoch 31/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.1174, acc=
Epoch 31/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.35it/s]
Epoch 31: Train Loss: 0.0604, Train Acc: 0.9790, Val Loss: 0.3224, Val Acc: 0.9173
Epoch 32/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0779, acc=
Epoch 32/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.00it/s]
Epoch 32: Train Loss: 0.0579, Train Acc: 0.9801, Val Loss: 0.2996, Val Acc: 0.9243
  ✅ New best model saved with val_acc: 0.9243
Epoch 33/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.1351, acc=
Epoch 33/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 33: Train Loss: 0.0529, Train Acc: 0.9815, Val Loss: 0.2870, Val Acc: 0.9256
  ✅ New best model saved with val_acc: 0.9256
Epoch 34/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0138, acc=
Epoch 34/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 34: Train Loss: 0.0563, Train Acc: 0.9805, Val Loss: 0.2990, Val Acc: 0.9256
Epoch 35/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0124, acc=
Epoch 35/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 35: Train Loss: 0.0532, Train Acc: 0.9809, Val Loss: 0.2740, Val Acc: 0.9302
  ✅ New best model saved with val_acc: 0.9302
Epoch 36/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0203, acc=
Epoch 36/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 36: Train Loss: 0.0469, Train Acc: 0.9840, Val Loss: 0.3186, Val Acc: 0.9245
Epoch 37/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0687, acc=
Epoch 37/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 37: Train Loss: 0.0521, Train Acc: 0.9818, Val Loss: 0.3021, Val Acc: 0.9225
Epoch 38/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0343, acc=
Epoch 38/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.10it/s]
Epoch 38: Train Loss: 0.0443, Train Acc: 0.9851, Val Loss: 0.3054, Val Acc: 0.9289
Epoch 39/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0054, acc=
Epoch 39/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 39: Train Loss: 0.0395, Train Acc: 0.9867, Val Loss: 0.3299, Val Acc: 0.9227
Epoch 40/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0187, acc=
Epoch 40/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.68it/s]
Epoch 40: Train Loss: 0.0404, Train Acc: 0.9861, Val Loss: 0.3245, Val Acc: 0.9248
Epoch 41/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0264, acc=
Epoch 41/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.05it/s]
Epoch 41: Train Loss: 0.0421, Train Acc: 0.9850, Val Loss: 0.2878, Val Acc: 0.9321
  ✅ New best model saved with val_acc: 0.9321
Epoch 42/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0324, acc=
Epoch 42/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 42: Train Loss: 0.0380, Train Acc: 0.9868, Val Loss: 0.3080, Val Acc: 0.9296
Epoch 43/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0142, acc=
Epoch 43/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 43: Train Loss: 0.0359, Train Acc: 0.9881, Val Loss: 0.3423, Val Acc: 0.9240
Epoch 44/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0325, acc=
Epoch 44/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.33it/s]
Epoch 44: Train Loss: 0.0335, Train Acc: 0.9882, Val Loss: 0.2959, Val Acc: 0.9308
Epoch 45/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0167, acc=
Epoch 45/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 45: Train Loss: 0.0323, Train Acc: 0.9891, Val Loss: 0.3192, Val Acc: 0.9304
Epoch 46/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0300, acc=
Epoch 46/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.19it/s]
Epoch 46: Train Loss: 0.0303, Train Acc: 0.9901, Val Loss: 0.3113, Val Acc: 0.9326
  ✅ New best model saved with val_acc: 0.9326
Epoch 47/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0171, acc=
Epoch 47/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.40it/s]
Epoch 47: Train Loss: 0.0313, Train Acc: 0.9892, Val Loss: 0.3070, Val Acc: 0.9280
Epoch 48/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0445, acc=
Epoch 48/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.04it/s]
Epoch 48: Train Loss: 0.0277, Train Acc: 0.9911, Val Loss: 0.3276, Val Acc: 0.9304
Epoch 49/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0223, acc=
Epoch 49/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.87it/s]
Epoch 49: Train Loss: 0.0285, Train Acc: 0.9906, Val Loss: 0.3089, Val Acc: 0.9310
Epoch 50/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0294, acc=
Epoch 50/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.31it/s]
Epoch 50: Train Loss: 0.0266, Train Acc: 0.9908, Val Loss: 0.2960, Val Acc: 0.9346
  ✅ New best model saved with val_acc: 0.9346
Epoch 51/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0140, acc=
Epoch 51/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 51: Train Loss: 0.0236, Train Acc: 0.9916, Val Loss: 0.3026, Val Acc: 0.9321
Epoch 52/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0431, acc=
Epoch 52/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 52: Train Loss: 0.0222, Train Acc: 0.9924, Val Loss: 0.3431, Val Acc: 0.9305
Epoch 53/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0165, acc=
Epoch 53/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.35it/s]
Epoch 53: Train Loss: 0.0205, Train Acc: 0.9932, Val Loss: 0.3228, Val Acc: 0.9335
Epoch 54/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0156, acc=
Epoch 54/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.34it/s]
Epoch 54: Train Loss: 0.0231, Train Acc: 0.9923, Val Loss: 0.3140, Val Acc: 0.9308
Epoch 55/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0061, acc=
Epoch 55/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 55: Train Loss: 0.0180, Train Acc: 0.9938, Val Loss: 0.3069, Val Acc: 0.9371
  ✅ New best model saved with val_acc: 0.9371
Epoch 56/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0272, acc=
Epoch 56/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 56: Train Loss: 0.0190, Train Acc: 0.9935, Val Loss: 0.3035, Val Acc: 0.9343
Epoch 57/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0069, acc=
Epoch 57/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 57: Train Loss: 0.0203, Train Acc: 0.9930, Val Loss: 0.3298, Val Acc: 0.9292
Epoch 58/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0009, acc=
Epoch 58/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 58: Train Loss: 0.0167, Train Acc: 0.9943, Val Loss: 0.3187, Val Acc: 0.9341
Epoch 59/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0022, acc=
Epoch 59/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 59: Train Loss: 0.0135, Train Acc: 0.9955, Val Loss: 0.3143, Val Acc: 0.9372
  ✅ New best model saved with val_acc: 0.9372
Epoch 60/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0061, acc=
Epoch 60/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.17it/s]
Epoch 60: Train Loss: 0.0138, Train Acc: 0.9953, Val Loss: 0.3087, Val Acc: 0.9381
  ✅ New best model saved with val_acc: 0.9381
Epoch 61/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0201, acc=
Epoch 61/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.33it/s]
Epoch 61: Train Loss: 0.0110, Train Acc: 0.9964, Val Loss: 0.3177, Val Acc: 0.9391
  ✅ New best model saved with val_acc: 0.9391
Epoch 62/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0014, acc=
Epoch 62/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.27it/s]
Epoch 62: Train Loss: 0.0133, Train Acc: 0.9954, Val Loss: 0.2914, Val Acc: 0.9411
  ✅ New best model saved with val_acc: 0.9411
Epoch 63/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0062, acc=
Epoch 63/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 63: Train Loss: 0.0110, Train Acc: 0.9962, Val Loss: 0.2947, Val Acc: 0.9396
Epoch 64/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0065, acc=
Epoch 64/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 64: Train Loss: 0.0109, Train Acc: 0.9963, Val Loss: 0.2821, Val Acc: 0.9421
  ✅ New best model saved with val_acc: 0.9421
Epoch 65/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0044, acc=
Epoch 65/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 65: Train Loss: 0.0093, Train Acc: 0.9966, Val Loss: 0.3055, Val Acc: 0.9412
Epoch 66/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0120, acc=
Epoch 66/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.36it/s]
Epoch 66: Train Loss: 0.0084, Train Acc: 0.9974, Val Loss: 0.3079, Val Acc: 0.9397
Epoch 67/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0067, acc=
Epoch 67/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 67: Train Loss: 0.0090, Train Acc: 0.9972, Val Loss: 0.3185, Val Acc: 0.9395
Epoch 68/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0015, acc=
Epoch 68/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 68: Train Loss: 0.0072, Train Acc: 0.9977, Val Loss: 0.3053, Val Acc: 0.9427
  ✅ New best model saved with val_acc: 0.9427
Epoch 69/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0011, acc=
Epoch 69/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.12it/s]
Epoch 69: Train Loss: 0.0066, Train Acc: 0.9978, Val Loss: 0.2921, Val Acc: 0.9446
  ✅ New best model saved with val_acc: 0.9446
Epoch 70/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0034, acc=
Epoch 70/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 70: Train Loss: 0.0056, Train Acc: 0.9982, Val Loss: 0.3022, Val Acc: 0.9423
Epoch 71/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0007, acc=
Epoch 71/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.25it/s]
Epoch 71: Train Loss: 0.0056, Train Acc: 0.9980, Val Loss: 0.3007, Val Acc: 0.9457
  ✅ New best model saved with val_acc: 0.9457
Epoch 72/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0013, acc=
Epoch 72/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 72: Train Loss: 0.0045, Train Acc: 0.9984, Val Loss: 0.3100, Val Acc: 0.9468
  ✅ New best model saved with val_acc: 0.9468
Epoch 73/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 73/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.21it/s]
Epoch 73: Train Loss: 0.0056, Train Acc: 0.9980, Val Loss: 0.3233, Val Acc: 0.9398
Epoch 74/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0001, acc=
Epoch 74/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.37it/s]
Epoch 74: Train Loss: 0.0042, Train Acc: 0.9984, Val Loss: 0.3070, Val Acc: 0.9433
Epoch 75/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 75/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 75: Train Loss: 0.0037, Train Acc: 0.9988, Val Loss: 0.3084, Val Acc: 0.9437
Epoch 76/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0004, acc=
Epoch 76/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 76: Train Loss: 0.0032, Train Acc: 0.9991, Val Loss: 0.3127, Val Acc: 0.9442
Epoch 77/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 77/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.22it/s]
Epoch 77: Train Loss: 0.0027, Train Acc: 0.9991, Val Loss: 0.3245, Val Acc: 0.9430
Epoch 78/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 78/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.97it/s]
Epoch 78: Train Loss: 0.0023, Train Acc: 0.9992, Val Loss: 0.3196, Val Acc: 0.9439
Epoch 79/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0001, acc=
Epoch 79/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.35it/s]
Epoch 79: Train Loss: 0.0022, Train Acc: 0.9993, Val Loss: 0.3143, Val Acc: 0.9456
Epoch 80/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0003, acc=
Epoch 80/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 80: Train Loss: 0.0018, Train Acc: 0.9995, Val Loss: 0.3153, Val Acc: 0.9471
  ✅ New best model saved with val_acc: 0.9471
Epoch 81/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0004, acc=
Epoch 81/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.33it/s]
Epoch 81: Train Loss: 0.0014, Train Acc: 0.9996, Val Loss: 0.3200, Val Acc: 0.9453
Epoch 82/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0023, acc=
Epoch 82/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 82: Train Loss: 0.0012, Train Acc: 0.9997, Val Loss: 0.3198, Val Acc: 0.9455
Epoch 83/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0005, acc=
Epoch 83/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.36it/s]
Epoch 83: Train Loss: 0.0013, Train Acc: 0.9996, Val Loss: 0.3226, Val Acc: 0.9460
Epoch 84/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0009, acc=
Epoch 84/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.95it/s]
Epoch 84: Train Loss: 0.0011, Train Acc: 0.9997, Val Loss: 0.3200, Val Acc: 0.9471
Epoch 85/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0014, acc=
Epoch 85/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 85: Train Loss: 0.0012, Train Acc: 0.9997, Val Loss: 0.3253, Val Acc: 0.9468
Epoch 86/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0064, acc=
Epoch 86/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.26it/s]
Epoch 86: Train Loss: 0.0007, Train Acc: 0.9998, Val Loss: 0.3250, Val Acc: 0.9456
Epoch 87/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0001, acc=
Epoch 87/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.33it/s]
Epoch 87: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3258, Val Acc: 0.9465
Epoch 88/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0000, acc=
Epoch 88/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.23it/s]
Epoch 88: Train Loss: 0.0007, Train Acc: 0.9998, Val Loss: 0.3167, Val Acc: 0.9475
  ✅ New best model saved with val_acc: 0.9475
Epoch 89/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0000, acc=
Epoch 89/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.29it/s]
Epoch 89: Train Loss: 0.0006, Train Acc: 0.9999, Val Loss: 0.3197, Val Acc: 0.9462
Epoch 90/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0008, acc=
Epoch 90/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.16it/s]
Epoch 90: Train Loss: 0.0008, Train Acc: 0.9998, Val Loss: 0.3192, Val Acc: 0.9464
Epoch 91/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 91/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.23it/s]
Epoch 91: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3191, Val Acc: 0.9473
Epoch 92/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0001, acc=
Epoch 92/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.32it/s]
Epoch 92: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3191, Val Acc: 0.9473
Epoch 93/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0026, acc=
Epoch 93/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.28it/s]
Epoch 93: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3163, Val Acc: 0.9480
  ✅ New best model saved with val_acc: 0.9480
Epoch 94/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0007, acc=
Epoch 94/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.33it/s]
Epoch 94: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3166, Val Acc: 0.9479
Epoch 95/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0001, acc=
Epoch 95/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.31it/s]
Epoch 95: Train Loss: 0.0004, Train Acc: 0.9999, Val Loss: 0.3178, Val Acc: 0.9471
Epoch 96/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0002, acc=
Epoch 96/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.18it/s]
Epoch 96: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3155, Val Acc: 0.9476
Epoch 97/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0004, acc=
Epoch 97/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.30it/s]
Epoch 97: Train Loss: 0.0003, Train Acc: 1.0000, Val Loss: 0.3172, Val Acc: 0.9475
Epoch 98/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0004, acc=
Epoch 98/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 50.85it/s]
Epoch 98: Train Loss: 0.0005, Train Acc: 0.9999, Val Loss: 0.3173, Val Acc: 0.9476
Epoch 99/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.87it/s, loss=0.0000, acc=
Epoch 99/100 [Val]: 100%|███████████████████████| 79/79 [00:01<00:00, 51.14it/s]
Epoch 99: Train Loss: 0.0003, Train Acc: 0.9999, Val Loss: 0.3148, Val Acc: 0.9484
  ✅ New best model saved with val_acc: 0.9484
Epoch 100/100 [Train]: 100%|█| 391/391 [00:26<00:00, 14.86it/s, loss=0.0000, acc
Epoch 100/100 [Val]: 100%|██████████████████████| 79/79 [00:01<00:00, 51.38it/s]
Epoch 100: Train Loss: 0.0003, Train Acc: 0.9999, Val Loss: 0.3145, Val Acc: 0.9480
✅ Training completed. Best validation accuracy: 0.9484

=== TRAINING TTT MODELS ===
✅ Loaded base model for TTT training

🚀 Training TTT model on CIFAR-10...
TTT Epoch 1/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 1: Train Loss: 1.3077, Val Loss: 1.2023
TTT Epoch 2/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 2: Train Loss: 0.8765, Val Loss: 0.8057
TTT Epoch 3/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 3: Train Loss: 0.7354, Val Loss: 0.7008
TTT Epoch 4/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 4: Train Loss: 0.6970, Val Loss: 0.6534
TTT Epoch 5/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 5: Train Loss: 0.6780, Val Loss: 0.6400
TTT Epoch 6/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 6: Train Loss: 0.6613, Val Loss: 0.6272
TTT Epoch 7/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 7: Train Loss: 0.6467, Val Loss: 0.6362
TTT Epoch 8/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 8: Train Loss: 0.6462, Val Loss: 0.6154
TTT Epoch 9/50: 100%|█████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 9: Train Loss: 0.6245, Val Loss: 0.6131
TTT Epoch 10/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 10: Train Loss: 0.6201, Val Loss: 0.5992
TTT Epoch 11/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 11: Train Loss: 0.6069, Val Loss: 0.5887
TTT Epoch 12/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 12: Train Loss: 0.6000, Val Loss: 0.5885
TTT Epoch 13/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 13: Train Loss: 0.5951, Val Loss: 0.5840
TTT Epoch 14/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 14: Train Loss: 0.5908, Val Loss: 0.5687
TTT Epoch 15/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 15: Train Loss: 0.5923, Val Loss: 0.5996
TTT Epoch 16/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 16: Train Loss: 0.5835, Val Loss: 0.5881
TTT Epoch 17/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 17: Train Loss: 0.5733, Val Loss: 0.5726
TTT Epoch 18/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 18: Train Loss: 0.5728, Val Loss: 0.5619
TTT Epoch 19/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 19: Train Loss: 0.5671, Val Loss: 0.5843
TTT Epoch 20/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 20: Train Loss: 0.5667, Val Loss: 0.5547
TTT Epoch 21/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 21: Train Loss: 0.5659, Val Loss: 0.5401
TTT Epoch 22/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 22: Train Loss: 0.5617, Val Loss: 0.5518
TTT Epoch 23/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 23: Train Loss: 0.5589, Val Loss: 0.5437
TTT Epoch 24/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 24: Train Loss: 0.5584, Val Loss: 0.5361
TTT Epoch 25/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 25: Train Loss: 0.5519, Val Loss: 0.5263
TTT Epoch 26/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 26: Train Loss: 0.5518, Val Loss: 0.5441
TTT Epoch 27/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 27: Train Loss: 0.5490, Val Loss: 0.5222
TTT Epoch 28/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 28: Train Loss: 0.5390, Val Loss: 0.5238
TTT Epoch 29/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 29: Train Loss: 0.5423, Val Loss: 0.5431
TTT Epoch 30/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 30: Train Loss: 0.5461, Val Loss: 0.5222
TTT Epoch 31/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 31: Train Loss: 0.5342, Val Loss: 0.5181
TTT Epoch 32/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 32: Train Loss: 0.5327, Val Loss: 0.5258
TTT Epoch 33/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 33: Train Loss: 0.5293, Val Loss: 0.5319
TTT Epoch 34/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 34: Train Loss: 0.5267, Val Loss: 0.5304
TTT Epoch 35/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 35: Train Loss: 0.5245, Val Loss: 0.5079
TTT Epoch 36/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 36: Train Loss: 0.5226, Val Loss: 0.5213
TTT Epoch 37/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 37: Train Loss: 0.5208, Val Loss: 0.5128
TTT Epoch 38/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 38: Train Loss: 0.5219, Val Loss: 0.5265
TTT Epoch 39/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 39: Train Loss: 0.5128, Val Loss: 0.5407
TTT Epoch 40/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.12it/s]
TTT Epoch 40: Train Loss: 0.5183, Val Loss: 0.5107
TTT Epoch 41/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 41: Train Loss: 0.5130, Val Loss: 0.5086
TTT Epoch 42/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 42: Train Loss: 0.5143, Val Loss: 0.4940
TTT Epoch 43/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 43: Train Loss: 0.5125, Val Loss: 0.4976
TTT Epoch 44/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 44: Train Loss: 0.5082, Val Loss: 0.5278
TTT Epoch 45/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 45: Train Loss: 0.5121, Val Loss: 0.4900
TTT Epoch 46/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 46: Train Loss: 0.5040, Val Loss: 0.5034
TTT Epoch 47/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 47: Train Loss: 0.5027, Val Loss: 0.4936
TTT Epoch 48/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 48: Train Loss: 0.5030, Val Loss: 0.5005
TTT Epoch 49/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.14it/s]
TTT Epoch 49: Train Loss: 0.4997, Val Loss: 0.4981
TTT Epoch 50/50: 100%|████████████████████████| 391/391 [00:42<00:00,  9.13it/s]
TTT Epoch 50: Train Loss: 0.4965, Val Loss: 0.4914

🚀 Training TTT3fc model on CIFAR-10...
Using device: cuda
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1024, in <module>
    main()
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 993, in main
    train_ttt_models(train_loader, val_loader)
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 431, in train_ttt_models
    train_ttt3fc_model(
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/ttt3fc_model.py", line 395, in train_ttt3fc_model
    train_dataset = TinyImageNetDataset(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/new_new.py", line 176, in __init__
    with open(os.path.join(root_dir, 'wnids.txt'), 'r') as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: '../../cifar10/wnids.txt'
