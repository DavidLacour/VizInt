No specific arguments provided. Using default behavior:
- Training missing models
- Evaluating all existing models
✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000
✅ Loaded CIFAR-10 dataset (without normalization)
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

✓ Main ViT model already exists at ../../cifar10checkpoints/bestmodel_main/best_model.pt

✓ Robust ViT model already exists at ../../cifar10checkpoints/bestmodel_robust/best_model.pt

✓ ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_baseline/best_model.pt

✓ Pretrained ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_pretrained/best_model.pt

✓ TTT model already exists at ../../cifar10checkpoints/bestmodel_ttt/best_model.pt
✓ TTT3fc model already exists at ../../cifar10checkpoints/bestmodel_ttt3fc/best_model.pt

✓ Blended models already exist:
  - Blended: ../../cifar10checkpoints/bestmodel_blended/best_model.pt
  - Blended3fc: ../../cifar10checkpoints/bestmodel_blended3fc/best_model.pt

✓ Healer model already exists at ../../cifar10checkpoints/bestmodel_healer/best_model.pt

=== EVALUATION PHASE ===

📋 Part 1: Clean Data Evaluation

================================================================================
📊 EVALUATING ALL MODELS ON CIFAR-10
================================================================================

🔍 Evaluating Main ViT...
Evaluating Main ViT: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 17.70it/s]
✅ Main ViT Accuracy: 0.4691

🔍 Evaluating Robust ViT...
Evaluating Robust ViT: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 18.39it/s]
✅ Robust ViT Accuracy: 0.2904

🔍 Evaluating ResNet18 Baseline...
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/david-lacour/.pyenv/versions/myenv/lib/python3.12/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=None`.
  warnings.warn(msg)
Evaluating ResNet18 Baseline: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 50.92it/s]
✅ ResNet18 Baseline Accuracy: 0.9188

🔍 Evaluating ResNet18 Pretrained...
Evaluating ResNet18 Pretrained: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 51.58it/s]
✅ ResNet18 Pretrained Accuracy: 0.9285

🔍 Evaluating TTT...
Evaluating TTT: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.20it/s]
✅ TTT Accuracy: 0.4402

🔍 Evaluating BlendedTTT...
Evaluating BlendedTTT: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 18.22it/s]
✅ BlendedTTT Accuracy: 0.7076

🔍 Evaluating TTT3fc...
Evaluating TTT3fc: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 58.16it/s]
✅ TTT3fc Accuracy: 0.0000

🔍 Evaluating BlendedTTT3fc...
Evaluating BlendedTTT3fc: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 18.14it/s]
✅ BlendedTTT3fc Accuracy: 0.6033

🔍 Evaluating Healer...
   Note: Healer model predicts transformation types, not classes.
   See healer training logs for transformation prediction accuracy.

================================================================================
📊 EVALUATION SUMMARY
================================================================================
Model                       Accuracy
----------------------------------------
🥇 ResNet18 Pretrained        0.9285
🥈 ResNet18 Baseline          0.9188
🥉 BlendedTTT                 0.7076
   BlendedTTT3fc              0.6033
   Main ViT                   0.4691
   TTT                        0.4402
   Robust ViT                 0.2904
   TTT3fc                     0.0000

📋 Part 2: Transformation Robustness Evaluation

================================================================================
📊 EVALUATING MODELS WITH CONTINUOUS TRANSFORMATIONS
================================================================================
Severities to test: [0.0, 0.3, 0.5, 0.7, 1.0]

🔍 Evaluating Main ViT...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 18.34it/s]
  Severity 0.0: 0.1520
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.93it/s]
  Severity 0.3: 0.1349
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 15.01it/s]
  Severity 0.5: 0.1271
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.87it/s]
  Severity 0.7: 0.1270
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.96it/s]
  Severity 1.0: 0.1236

🔍 Evaluating Robust ViT...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 18.11it/s]
  Severity 0.0: 0.2058
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.93it/s]
  Severity 0.3: 0.2063
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.85it/s]
  Severity 0.5: 0.2053
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.93it/s]
  Severity 0.7: 0.1869
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:05<00:00, 14.86it/s]
  Severity 1.0: 0.1772

🔍 Evaluating ResNet18 Baseline...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 51.03it/s]
  Severity 0.0: 0.4481
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.39it/s]
  Severity 0.3: 0.2356
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.34it/s]
  Severity 0.5: 0.2180
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.45it/s]
  Severity 0.7: 0.1963
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.35it/s]
  Severity 1.0: 0.1977

🔍 Evaluating ResNet18 Pretrained...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 51.17it/s]
  Severity 0.0: 0.3755
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.59it/s]
  Severity 0.3: 0.2067
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.46it/s]
  Severity 0.5: 0.1914
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.52it/s]
  Severity 0.7: 0.1876
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:02<00:00, 28.60it/s]
  Severity 1.0: 0.1742

🔍 Evaluating TTT...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 13.04it/s]
  Severity 0.0: 0.4402
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.66it/s]
  Severity 0.3: 0.3311
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.64it/s]
  Severity 0.5: 0.2945
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.63it/s]
  Severity 0.7: 0.2799
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:07<00:00, 10.72it/s]
  Severity 1.0: 0.2730

🔍 Evaluating BlendedTTT...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 16.39it/s]
  Severity 0.0: 0.7076
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.85it/s]
  Severity 0.3: 0.6271
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.79it/s]
  Severity 0.5: 0.5873
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.79it/s]
  Severity 0.7: 0.5629
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.85it/s]
  Severity 1.0: 0.5484

🔍 Evaluating TTT3fc...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:01<00:00, 41.97it/s]
  Severity 0.0: 0.0000
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:03<00:00, 23.46it/s]
  Severity 0.3: 0.0000
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:03<00:00, 23.46it/s]
  Severity 0.5: 0.0000
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:03<00:00, 23.38it/s]
  Severity 0.7: 0.0000
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:03<00:00, 23.46it/s]
  Severity 1.0: 0.0000

🔍 Evaluating Healer...
   Skipping healer model (doesn't do classification)

🔍 Evaluating BlendedTTT3fc...
Severity 0.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:04<00:00, 16.49it/s]
  Severity 0.0: 0.6033
Severity 0.3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.83it/s]
  Severity 0.3: 0.5117
Severity 0.5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.61it/s]
  Severity 0.5: 0.4933
Severity 0.7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.80it/s]
  Severity 0.7: 0.4651
Severity 1.0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 79/79 [00:06<00:00, 12.84it/s]
  Severity 1.0: 0.4402

====================================================================================================
📊 TRANSFORMATION ROBUSTNESS SUMMARY
====================================================================================================
Model                       Sev 0.0   Sev 0.3   Sev 0.5   Sev 0.7   Sev 1.0    Avg Drop
----------------------------------------------------------------------------------------------------
Main ViT                     0.1520    0.1349    0.1271    0.1270    0.1236      0.0238
Robust ViT                   0.2058    0.2063    0.2053    0.1869    0.1772      0.0119
ResNet18 Baseline            0.4481    0.2356    0.2180    0.1963    0.1977      0.2362
ResNet18 Pretrained          0.3755    0.2067    0.1914    0.1876    0.1742      0.1855
TTT                          0.4402    0.3311    0.2945    0.2799    0.2730      0.1456
BlendedTTT                   0.7076    0.6271    0.5873    0.5629    0.5484      0.1262
TTT3fc                       0.0000    0.0000    0.0000    0.0000    0.0000      0.0000
BlendedTTT3fc                0.6033    0.5117    0.4933    0.4651    0.4402      0.1257

📋 Part 3: Healer-Guided Inverse Transform Evaluation
✅ Loaded Healer model

🔍 Evaluating Main ViT with Healer Guidance...
Severity 0.3:   0%|                                                                                                                                              | 0/79 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 2230, in <module>
    main()
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 2182, in main
    main_vit_healer_results = evaluate_vit_with_healer_guidance(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1669, in evaluate_vit_with_healer_guidance
    'translate_x': healer_output['translate_x'][0].item(),
                   ~~~~~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: 'translate_x'
