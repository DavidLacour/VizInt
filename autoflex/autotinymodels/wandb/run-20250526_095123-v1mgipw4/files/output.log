✅ Created checkpoint directory: ../../cifar10checkpoints
✅ Loaded CIFAR-10 dataset
   Training samples: 50000
   Validation samples: 10000

================================================================================
🚀 CIFAR-10 MODEL TRAINING AND EVALUATION PIPELINE
================================================================================
📁 Dataset: ../../cifar10
📁 Checkpoints: ../../cifar10checkpoints
🎯 Device: cuda

✓ Main ViT model already exists at ../../cifar10checkpoints/bestmodel_main/best_model.pt

✓ Robust ViT model already exists at ../../cifar10checkpoints/bestmodel_robust/best_model.pt

✓ ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_baseline/best_model.pt

✓ Pretrained ResNet baseline already exists at ../../cifar10checkpoints/bestmodel_resnet18_pretrained/best_model.pt

✓ TTT model already exists at ../../cifar10checkpoints/bestmodel_ttt/best_model.pt
✓ TTT3fc model already exists at ../../cifar10checkpoints/bestmodel_ttt3fc/best_model.pt

=== TRAINING BLENDED MODELS ===
✅ Loaded base model for Blended training

🚀 Training BlendedTTT model on CIFAR-10...
Blended Epoch 1/50: 100%|█████████████████████| 391/391 [01:07<00:00,  5.82it/s]
Blended Epoch 1: Train Loss: 2.5289, Train Acc: 0.3013, Val Acc: 0.4506
  ✅ New best model saved with val_acc: 0.4506
Blended Epoch 2/50: 100%|█████████████████████| 391/391 [01:07<00:00,  5.76it/s]
Blended Epoch 2: Train Loss: 2.0645, Train Acc: 0.4757, Val Acc: 0.5564
  ✅ New best model saved with val_acc: 0.5564
Blended Epoch 3/50: 100%|█████████████████████| 391/391 [01:08<00:00,  5.72it/s]
Blended Epoch 3: Train Loss: 1.7293, Train Acc: 0.5384, Val Acc: 0.5579
  ✅ New best model saved with val_acc: 0.5579
Blended Epoch 4/50: 100%|█████████████████████| 391/391 [01:08<00:00,  5.71it/s]
Blended Epoch 4: Train Loss: 1.5195, Train Acc: 0.5849, Val Acc: 0.6350
  ✅ New best model saved with val_acc: 0.6350
Blended Epoch 5/50: 100%|█████████████████████| 391/391 [01:08<00:00,  5.69it/s]
Blended Epoch 5: Train Loss: 1.4391, Train Acc: 0.6087, Val Acc: 0.6360
  ✅ New best model saved with val_acc: 0.6360
Blended Epoch 6/50: 100%|█████████████████████| 391/391 [01:12<00:00,  5.41it/s]
Blended Epoch 6: Train Loss: 1.3656, Train Acc: 0.6312, Val Acc: 0.6728
  ✅ New best model saved with val_acc: 0.6728
Blended Epoch 7/50: 100%|█████████████████████| 391/391 [01:18<00:00,  4.99it/s]
Blended Epoch 7: Train Loss: 1.3069, Train Acc: 0.6500, Val Acc: 0.6811
  ✅ New best model saved with val_acc: 0.6811
Blended Epoch 8/50: 100%|█████████████████████| 391/391 [01:14<00:00,  5.27it/s]
Blended Epoch 8: Train Loss: 1.2699, Train Acc: 0.6637, Val Acc: 0.7034
  ✅ New best model saved with val_acc: 0.7034
Blended Epoch 9/50: 100%|█████████████████████| 391/391 [01:13<00:00,  5.35it/s]
Blended Epoch 9: Train Loss: 1.2256, Train Acc: 0.6789, Val Acc: 0.7003
  No improvement for 1 epochs
Blended Epoch 10/50: 100%|████████████████████| 391/391 [01:10<00:00,  5.57it/s]
Blended Epoch 10: Train Loss: 1.1980, Train Acc: 0.6868, Val Acc: 0.7243
  ✅ New best model saved with val_acc: 0.7243
Blended Epoch 11/50: 100%|████████████████████| 391/391 [01:10<00:00,  5.58it/s]
Blended Epoch 11: Train Loss: 1.1601, Train Acc: 0.6990, Val Acc: 0.7197
  No improvement for 1 epochs
Blended Epoch 12/50: 100%|████████████████████| 391/391 [01:11<00:00,  5.50it/s]
Blended Epoch 12: Train Loss: 1.1349, Train Acc: 0.7072, Val Acc: 0.7397
  ✅ New best model saved with val_acc: 0.7397
Blended Epoch 13/50: 100%|████████████████████| 391/391 [01:10<00:00,  5.51it/s]
Blended Epoch 13: Train Loss: 1.1103, Train Acc: 0.7140, Val Acc: 0.7493
  ✅ New best model saved with val_acc: 0.7493
Blended Epoch 14/50: 100%|████████████████████| 391/391 [01:09<00:00,  5.61it/s]
Blended Epoch 14: Train Loss: 1.0898, Train Acc: 0.7217, Val Acc: 0.7522
  ✅ New best model saved with val_acc: 0.7522
Blended Epoch 15/50: 100%|████████████████████| 391/391 [01:11<00:00,  5.47it/s]
Blended Epoch 15: Train Loss: 1.0628, Train Acc: 0.7275, Val Acc: 0.7535
  ✅ New best model saved with val_acc: 0.7535
Blended Epoch 16/50: 100%|████████████████████| 391/391 [01:10<00:00,  5.53it/s]
Blended Epoch 16: Train Loss: 1.0552, Train Acc: 0.7310, Val Acc: 0.7615
  ✅ New best model saved with val_acc: 0.7615
Blended Epoch 17/50: 100%|████████████████████| 391/391 [01:11<00:00,  5.47it/s]
Blended Epoch 17: Train Loss: 1.0253, Train Acc: 0.7430, Val Acc: 0.7617
  ✅ New best model saved with val_acc: 0.7617
Blended Epoch 18/50: 100%|████████████████████| 391/391 [01:11<00:00,  5.50it/s]
Blended Epoch 18: Train Loss: 1.0090, Train Acc: 0.7463, Val Acc: 0.7588
  No improvement for 1 epochs
Blended Epoch 19/50: 100%|████████████████████| 391/391 [01:11<00:00,  5.47it/s]
Blended Epoch 19: Train Loss: 0.9918, Train Acc: 0.7517, Val Acc: 0.7462
  No improvement for 2 epochs
Blended Epoch 20/50: 100%|████████████████████| 391/391 [01:10<00:00,  5.56it/s]
Blended Epoch 20: Train Loss: 0.9837, Train Acc: 0.7555, Val Acc: 0.7595
  No improvement for 3 epochs
Blended Epoch 21/50:  11%|██▎                  | 42/391 [00:07<01:04,  5.38it/s]
Traceback (most recent call last):
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1271, in <module>
    print(f"\n✓ Pretrained ResNet baseline already exists at {resnet_pretrained_path}")
    ^^^^^^
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 1252, in main
    if not args.retrain and not args.skip_training and (args.train_all or args.train_robust):
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/david-lacour/Documents/transformerVision/githubs/VizInt/autoflex/autotinymodels/main_cifar10_all.py", line 642, in train_blended_models
    # Training setup for BlendedTTT CIFAR-10
                          ^^^^^^^^^^^
KeyboardInterrupt
